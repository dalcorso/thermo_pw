%!
%! Copyright (C) 2014-2021 Andrea Dal Corso 
%! This file is distributed under the terms of the
%! GNU General Public License. See the file `License'
%! in the root directory of the present distribution,
%! or http://www.gnu.org/copyleft/gpl.txt .
%!
\documentclass[12pt,a4paper,twoside]{report}
\def\version{1.6.1}

\usepackage[T1]{fontenc}
\usepackage{tcolorbox}
\usepackage{bookman}
\usepackage{html}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage[Lenny]{fncychap}
\usepackage{color}
\usepackage{geometry}
\usepackage{amsmath}
\usepackage{mathtools}

\tcbuselibrary{breakable}
\pagestyle{fancy}
\lhead{Thermodynamics of crystals}
\rhead{}
\cfoot{\thepage}

\newgeometry{
      top=3cm,
      bottom=3cm,
      outer=2.25cm,
      inner=2.75cm,
}

\definecolor{web-blue}{rgb}{0,0.5,1.0}
\definecolor{steelblue}{rgb}{0.27,0.5,0.7}
\definecolor{coral}{rgb}{1.0,0.5,0.3}
\definecolor{red}{rgb}{1.0,0,0.0}
\definecolor{green}{rgb}{0.,0.5,0.0}
\definecolor{dark-blue}{rgb}{0.,0.0,0.6}
\definecolor{limegreen}{rgb}{0.19,0.8,0.19}
\definecolor{orange}{rgb}{1.0,0.44,0.0}
\definecolor{violet}{rgb}{0.50,0.33,0.9}
\definecolor{light-yellow}{rgb}{0.94,0.85,0.62}

\tcbset{colback=light-yellow,colframe=dark-blue,breakable}

\def\qe{{\sc Quantum ESPRESSO}}
\def\pwx{\texttt{pw.x}}
\def\phx{\texttt{ph.x}}
\def\configure{\texttt{configure}}
\def\PWscf{\texttt{PWscf}}
\def\PHonon{\texttt{PHonon}}
\def\tpw{{\sc Thermo\_pw}}
\def\make{\texttt{make}}


\begin{document} 

\author{Andrea Dal Corso \\ (SISSA - Trieste)}
\date{}

\title{
  \includegraphics[width=8cm]{thermo_pw.jpg} \\
  \vspace{3truecm}
  % title
  \Huge \color{dark-blue} {\sc Thermo\_pw}: Thermodynamics of crystals \\(v.\version)
}

\maketitle

\newpage

{\color{dark-blue}\tableofcontents}
\color{black}

\newpage

{\color{dark-blue}\chapter{Introduction}}
\color{black}

These notes describe the thermodynamics of crystals implemented in \tpw. \\
They are part of the \tpw\ package. The complete package is
available at \texttt{https://github.com/dalcorso/thermo\_pw}.

\newpage
{\color{coral}\section{People}}
\color{black}

These notes have been written by Andrea Dal Corso (SISSA - Trieste). \\
Disclaimer: I am not an expert of crystal thermodynamics. 
These notes reflect what I have understood so far and implemented in 
\tpw. If you think that some formula is wrong, 
that I misunderstood something, or that something can be calculated more 
simply, please let me know, I would like to learn more. 
You can contact me directly: \texttt{dalcorso@sissa.it} or send an
e-mail to the \texttt{thermo\_pw-forum} mailing list.

\newpage
{\color{coral}\section{Overview}}
\color{black}

The properties of a solid addressed by \tpw\ are described by the thermodynamic
theory of the elastic solid.[1,2] In this theory a solid is characterized by an
equilibrium configuration that depends on the temperature $T$ and on an
external stress $\sigma$ (assumed constant) that describes the forces 
that act on the surface. The state
of the solid is characterized by a reference configuration 
(for instance the equilibrium configuration at $T=0$ and $\sigma=0$) and 
a strain $\epsilon$ which describes the deformation with respect to the 
reference configuration. 
Within the quasi-harmonic approximation the solid has an internal
energy given by  
\begin{equation}
U=U_0 + U_{el} + U_{ph},
\end{equation}
where $U_0$ is the ground state energy of the electrons in the field 
of the nuclei fixed at the equilibrium positions at the given strain, 
$U_{el}$ is the additional electron energy due to the 
finite electron temperature and $U_{ph}$ is the vibrational energy of the nuclei. 
Given the phonon frequencies $\omega_{{\bf q},\nu}$ of the solid 
(at wavevector ${\bf q}$) we can write:
\begin{equation}
U_{ph} = \sum_{{\bf q},\nu} {\hbar \omega_{{\bf q},\nu} \over 2}
+ \sum_{{\bf q},\nu} {\hbar \omega_{{\bf q},\nu} \over 
e^{\beta \hbar \omega_{{\bf q},\nu}}-1},
\label{uvib}
\end{equation}
where $\beta=1/ k_B T$, $k_B$ is the Boltzmann constant, and $\hbar$ is the
Planck constant divided by $2\pi$.
Presently $U_0$ is calculated within density functional theory (DFT) and
$U_{ph}$ within density functional perturbation theory (DFPT). 
For metals the electronic contribution to the heat capacity is not 
completely negligible. \tpw\ allows its estimate for a gas of 
independent electrons with the density of states given by the DFT bands.
Similarly the Helmholtz free energy is $F=U_0+F_{el}+F_{ph}$ with:
\begin{equation}
F_{ph} = k_B T \sum_{{\bf q},\nu} \ln \left[ 2 \sinh \left({\beta \hbar 
\omega_{{\bf q},\nu} \over 2}\right) \right].
\nonumber
\end{equation}
Having the internal energy and the Helmholtz free energy, the entropy can 
be calculated as $S=(U-F)/T$.

\tpw\ calculates the energy, the Helmholtz free energy, and the
entropy of a unit cell of the solid for a given choice of the primitive 
Bravais lattice vectors ${\bf a}_1$, ${\bf a}_2$, and ${\bf a}_3$. These
vectors depend on a few parameters $\zeta_k$ that determine the size 
of the unit cell ($k$ is $1$ for cubic lattices, $2$ for tetragonal, hexagonal,
and trigonal lattices, $3$ for othorhombic lattices, $4$ for monoclinic
lattices and $6$ for the triclinic lattice).
The unit cell contains $N_{at}$ atoms
whose positions are indicated by ${\bf d}_s$ with $1\le s\le N_{at}$.
These positions are usually optimized so that the forces acting on atoms 
vanish at $T=0$ K.
The reference configuration of the solid is
characterized by a set of parameters $\zeta_{k,0}$ and a set of parameters 
$\zeta_k$ corresponds to a solid in a strained state.
Therefore, theoretically, we calculate the 
internal energy, the Helmholtz free energy, and the entropy as a 
function of strain and temperature.

Experimentally it is simpler to control the stress imposed on the solid,
usually a constant pressure.
Moreover in some cases the thermodynamic quantities are measured without 
heat exchange, that is at constant entropy instead of at constant temperature. 
In the thermodynamic theory of the elastic solid it is natural to consider two
functions. The internal energy as a function of strain and entropy  
to describe adiabatic properties and the Helmholtz free energy as a function
of strain and temperature to describe isothermal properties.
Therefore we can calculate directly isothermal quantities (measured at constant
temperature), but we need thermodynamics relationships to calculate
the adiabatic quantities (measured at constant entropy).

First derivatives of the Helmholtz free energy with respect to strain
give the stress acting of the solid and this gives one or more equations
of state that relate strain, stress, and temperature. 
Searching the strain for which the stress is zero we determine the 
equilibrium geometry of the solid at each temperature as the minimum of 
the Helmholtz free energy. From these information we can deduce the
thermal expansion of the solid. The first derivative of the entropy 
with respect to temperature at fixed strain multiplied by the temperature
is the heat capacity at constant strain. Second derivatives of the 
Helmholtz free energy with 
respect to strain calculated at the equilibrium geometry give the 
isothermal elastic constants at the given temperature and at zero pressure. 
From the elastic constants we can calculate the isothermal bulk modulus 
of the solid at any temperature. 
Thermal expansions and elastic constants allows the calculation of the thermal
stresses and using these quantities we can obtain the heat capacity at
constant stress, the adiabatic elastic constants and the bulk modulus.
Finally from the constant strain heat capacity and the thermal stresses 
we can calculate the anisotropic average Gr\"uneisen parameters.

The strain for which the stress is a given pressure (or stress) at a given
temperature minimizes the Gibbs free energy at that temperature and
pressure (or stress) and from the minimum of this function we can determine 
the equilibrium geometry of the solid as a function of temperature and 
pressure (or stress). 
From these information we can deduce the thermal expansion of the 
solid at fixed pressure (or stress). Second derivatives of the Gibbs free
energy with respect to strain give the isothermal elastic constants at the 
given temperature and pressure (or stress). From the elastic constants 
we can calculate the isothermal bulk modulus at the
given temperature and pressure (or stress).
%Thermal expansions and elastic constants allow the calculation of the thermal
%stresses at the given pressure (or stress) and using these quantities we 
%can obtain the adiabatic heat capacity, elastic constants, and bulk moduli at
%the given pressure (or stress) from the corresponding isothermal ones. 
%Finally from the constant strain heat capacity and the thermal stresses 
%we can calculate the anisotropic average Gr\"uneisen parameters at 
%the given temperature and pressure (or stress).

In this guide we define all the quantities described above and calculated 
by \tpw\ and give the formulas needed to relate the crystallographic
parameters $\zeta_k$ to the thermodynamic functions.

\newpage

{\color{dark-blue}\chapter{Crystal lattices}}
\color{black}

We start with a short review of the fourteen Bravais lattices and 
give their primitive lattice vectors chosen with the same definitions used
in \qe. 
The volume of one unit cell is indicated with $\Omega$ and the total 
volume of the solid is $V=N\Omega$ where $N$ is the number of unit cells.

{\color{web-blue}\subsection{Cubic system}}
\color{black}

The cubic system comprises three Bravais lattices. The cubic lattice
is:
\begin{eqnarray}
{\bf a}_1 &=& a (1, 0, 0), \nonumber \\
{\bf a}_2 &=& a (0, 1, 0), \nonumber \\
{\bf a}_3 &=& a (0, 0, 1). \nonumber
\nonumber
\end{eqnarray}
The volume of the unit cell is $\Omega = a^3$. \\
The face-centered cubic lattice is:
\begin{eqnarray}
{\bf a}_1 &=& {a \over 2} (-1, 0, 1), \nonumber \\
{\bf a}_2 &=& {a \over 2} (0, 1, 1), \nonumber \\
{\bf a}_3 &=& {a \over 2} (-1, 1, 0). \nonumber
\nonumber
\end{eqnarray}
The volume of the unit cell is $\Omega = a^3/4$. \\
The body-centered cubic lattice is:
\begin{eqnarray}
{\bf a}_1 &=&{a \over 2} (1, 1, 1), \nonumber \\
{\bf a}_2 &=&{a \over 2} (-1, 1, 1), \nonumber \\
{\bf a}_3 &=&{a \over 2} (-1, -1, 1). \nonumber
\nonumber
\end{eqnarray}
The volume of the unit cell is $\Omega = a^3/2$. \\
All three lattices are characterized by one parameter $\zeta_1=a$.

{\color{web-blue}\subsection{Tetragonal system}}
\color{black}

The tetragonal system comprises two Bravais lattices: the tetragonal
and the centered tetragonal lattices.\\
The tetragonal lattice is:
\begin{eqnarray}
{\bf a}_1 &=& a (1, 0, 0), \nonumber \\
{\bf a}_2 &=& a (0, 1, 0), \nonumber \\
{\bf a}_3 &=& a (0, 0, {c\over a}). \nonumber
\nonumber
\end{eqnarray}
The volume of the unit cell is $\Omega = a^2c$. \\
The centered tetragonal lattice is:
\begin{eqnarray}
{\bf a}_1 &=& {a \over 2} (1, -1, {c\over a}), \nonumber \\
{\bf a}_2 &=& {a \over 2} (1, 1, {c\over a}), \nonumber \\
{\bf a}_3 &=& {a \over 2} (-1, -1, {c\over a}). \nonumber
\nonumber
\end{eqnarray}
The volume of the unit cell is $\Omega = a^2c/2$. \\
Both lattices are characterized by two parameters $\zeta_1=a$ and 
$\zeta_2=c/a$.

{\color{web-blue}\subsection{Orthorhombic system}}
\color{black}

The orthorhombic system comprises four Bravais lattices.
The orthorhombic lattice:
\begin{eqnarray}
{\bf a}_1 &=& a (1, 0, 0), \nonumber \\
{\bf a}_2 &=& a (0, {b\over a}, 0), \nonumber \\
{\bf a}_3 &=& a (0, 0, {c\over a}). \nonumber
\nonumber
\end{eqnarray}
The volume of the unit cell is $\Omega = abc$. \\
The base-centered orthorhombic lattice. This lattice can be of three
types A, B, or C, but only two types are presently used. 
The C-type is:
\begin{eqnarray}
{\bf a}_1 &=& {a \over 2} (1, {b \over a}, 0), \nonumber \\
{\bf a}_2 &=& {a \over 2} (-1, {b \over a}, 0), \nonumber \\
{\bf a}_3 &=& a  (0, 0, {c \over a}), \nonumber
\nonumber
\end{eqnarray}
while the A-type is:
\begin{eqnarray}
{\bf a}_1 &=& a  (1, 0, 0), \nonumber \\
{\bf a}_2 &=& {a \over 2} (0, {b \over a}, -{c \over a}), \nonumber \\
{\bf a}_3 &=& {a \over 2} (0, {b \over a}, {c \over a}). \nonumber 
\nonumber
\end{eqnarray}
The volume of the unit cell is $\Omega = abc/2$ for both lattices. \\
The face-centered orthorhombic lattice:
\begin{eqnarray}
{\bf a}_1 &=& {a \over 2} (1, 0, {c \over a}), \nonumber \\
{\bf a}_2 &=& {a \over 2} (1, {b \over a}, 0), \nonumber \\
{\bf a}_3 &=& {a \over 2} (0, {b \over a}, {c \over a}). \nonumber
\nonumber
\end{eqnarray}
The volume of the unit cell is $\Omega = abc/4$. \\
The body-centered orthorhombic lattice:
\begin{eqnarray}
{\bf a}_1 &=& {a \over 2} (1, {b \over a}, {c \over a}), \nonumber \\
{\bf a}_2 &=& {a \over 2} (-1, {b \over a}, {c \over a}), \nonumber \\
{\bf a}_3 &=& {a \over 2} (-1, -{b \over a}, {c \over a}). \nonumber
\nonumber
\end{eqnarray}
The volume of the unit cell is $\Omega = abc/2$. \\
All four lattices are characterized by three parameters, 
$\zeta_1=a$, $\zeta_2=b/a$ and $\zeta_3=c/a$.

{\color{web-blue}\subsection{Monoclinic system}}
\color{black}

The monoclinic system comprises two Bravais lattices:
The monoclinic and the base-centered monoclinic lattices.
Each one of these two lattices can be $c$-unique or $b$-unique depending on
which axis is perpendicular to the other two. 
The $c$-unique monoclinic lattice is:
\begin{eqnarray}
{\bf a}_1 &=& a (1, 0, 0), \nonumber \\
{\bf a}_2 &=& a ({b \over a} \cos{\gamma}, {b \over a}\sin{\gamma}, 0), \nonumber \\
{\bf a}_3 &=& a (0, 0, {c \over a}). 
\nonumber
\end{eqnarray}
The volume of the unit cell is $\Omega = abc \sin\gamma$. \\
The $b$-unique monoclinic lattice is:
\begin{eqnarray}
{\bf a}_1 &=& a (1, 0, 0), \nonumber \\
{\bf a}_2 &=& a (0, {b \over a}, 0), \nonumber \\
{\bf a}_3 &=& a ({c \over a} \cos{\beta}, 0, {c \over a}\sin{\beta}), \nonumber 
\end{eqnarray}
The volume of the unit cell is $\Omega = abc \sin\beta$. \\
The $c$-unique base-centered monoclinic lattice is:
\begin{eqnarray}
{\bf a}_1 &=& a ({1\over 2}, 0, -{c \over 2 a}), \nonumber \\
{\bf a}_2 &=& a ({b \over a} \cos{\gamma}, {b \over a}\sin{\gamma}, 0), \nonumber \\
{\bf a}_3 &=& a ({1\over 2}, 0, {c \over 2 a}). 
\nonumber
\end{eqnarray}
The volume of the unit cell is $\Omega = abc \sin\gamma/2$. \\
The $b$ unique base-centered monoclinic lattice is:
\begin{eqnarray}
{\bf a}_1 &=& a ({1\over 2}, -{b \over 2 a}, 0), \nonumber \\
{\bf a}_2 &=& a ({1\over 2}, {b \over 2 a}, 0), \nonumber \\
{\bf a}_3 &=& a ({c \over a} \cos{\beta}, 0, {c \over a}\sin{\beta}), \nonumber 
\end{eqnarray}
The volume of the unit cell is $\Omega = abc \sin\beta/2$. \\
All lattices are characterized by four parameters $\zeta_1=a$, $\zeta_2=b/a$,
$\zeta_3=c/a$ and $\zeta_4=\cos\gamma$
($c$-unique) or $\cos\beta$ ($b$-unique).

{\color{web-blue}\subsection{Triclinic system}}
\color{black}

The triclinic system comprises only the triclinic Bravais lattice:
\begin{eqnarray}
{\bf a}_1 &=& a (1, 0, 0), \nonumber \\
{\bf a}_2 &=& a ({b \over a}\cos\gamma, {b \over a}\sin\gamma, 0), \nonumber \\
{\bf a}_3 &=& a ({c \over a} \cos{\beta}, {c \over a}(\cos\alpha-\cos\beta\cos\gamma)/\sin\gamma,\nonumber \\
&\phantom{=}& {c \over a}(1+2\cos\alpha\cos\beta\cos\gamma-\cos^2\alpha-\cos^2\beta-\cos^2\gamma), \nonumber 
\end{eqnarray}
The volume of the unit cell is $\Omega=abc \sin\gamma \left( 
1+2\cos\alpha\cos\beta\cos\gamma-\cos^2\alpha-\cos^2\beta-\cos^2\gamma\right)
$.
The lattice is characterized by six parameters $\zeta_1=a$, 
$\zeta_2=b$, $\zeta_3=c$, $\zeta_4=\cos\alpha$,
$\zeta_5=\cos\beta$, $\zeta_6=\cos\gamma$.

{\color{web-blue}\subsection{Hexagonal system}}
\color{black}

The hexagonal system comprises only the hexagonal Bravais lattice:
\begin{eqnarray}
{\bf a}_1 &=& a (1, 0, 0), \nonumber \\
{\bf a}_2 &=& a (-{1 \over 2}, {\sqrt{3} \over 2}, 0), \nonumber \\
{\bf a}_3 &=& a (0, 0, {c\over a}), \nonumber
\nonumber
\end{eqnarray}
The volume of the unit cell is $\sqrt{3} a^2 c /2$. \\
The lattice is characterized by two parameters $\zeta_1=a$ 
and $\zeta_2=c/a$.

{\color{web-blue}\subsection{Trigonal system}}
\color{black}

The trigonal system comprises two Bravais lattices: the hexagonal Bravais 
lattice described above or the rhombohedral Bravais lattice:
\begin{eqnarray}
{\bf a}_1 &=& a ({\sqrt{3}\over 2}\sin{\theta}, -{1\over 2} \sin{\theta},
          \cos{\theta}), 
\nonumber \\
{\bf a}_2 &=& a (0, \sin{\theta}, \cos{\theta}), 
\nonumber \\
{\bf a}_3 &=& a (-{\sqrt{3}\over 2} \sin{\theta}, -{1\over 2} \sin{\theta},
         \cos{\theta}), 
\nonumber \\
\nonumber
\end{eqnarray}
where $\sin{\theta}=\sqrt{2\over 3}\sqrt{1-\cos{\alpha}}$
and $\cos{\theta}=\sqrt{1\over 3}\sqrt{1 + 2 \cos{\alpha}}$. \\
The volume of the unit cell is $\Omega={3 \sqrt{3} \over 2} a^3 \sin^2\theta
\cos\theta$. \\
The lattice is characterized by two parameters $\zeta_1=a$ and 
$\zeta_2=\cos\alpha$.

\newpage

{\color{dark-blue}\chapter{The strain tensor}}
\color{black}

The strain is defined by a $3\times 3$ tensor
$\epsilon$. Applying a strain $\epsilon$ to a solid, 
the three primitive vectors ${\bf a}_1$, ${\bf a}_2$, and ${\bf a}_3$
becomes 
${\bf a}'_1$, ${\bf a}'_2$, and ${\bf a}'_3$, where:
\begin{equation}
{\bf a}'_{j,i} = {\bf a}_{j,i} +  \sum_{k=1}^3 \epsilon_{j,k} {\bf a}_{k,i}.
\label{strain_def}
\end{equation}
Here $i=1,2,3$ is the index of the primitive vector, while $k$ and $j$ run
on the three Cartesian coordinates. We consider only symmetric 
tensors $\epsilon_{j,k}=\epsilon_{k,j}$ removing any rotation. Moreover
we restrict ourselves to constant strain tensors so that the strained
solid is still periodic and can be described by a Bravais lattice.

In the classical elasticity theory, one
calls ${\bf X}$ the coordinates of an unstrained solid and
${\bf x}({\bf X})$ the position of each point ${\bf X}$ in
the strained solid. The derivatives with respect to $X_j$ of the
displacements of each point ${\bf u}= {\bf x} -{\bf X}$ 
$u_{i,j}= {\partial u_i \over \partial X_j}$ are called
displacement gradients. When $u_{i,j}$ are constant the strain
is called homogeneous and we have ${\bf x}_i({\bf X}) = 
\sum_j\alpha_{i,j} {\bf X}_j$ where 
$\alpha_{i,j}=\delta_{i,j}+u_{i,j}$ is a $3\times 3$ matrix. 
$\epsilon_{j,k}$
is the symmetrized tensor $\epsilon_{j,k}={1\over 2} ( u_{j,k} +
u_{k,j})$. Calling $\omega_{j,k}={1\over 2} ( u_{j,k} -
u_{k,j})$ the corresponding antisymmetric tensor, which describes
rotations, we can write $u_{i,j}=\epsilon_{i,j}+\omega_{i,j}$.

The strain of a solid can be described also from the change of the
distance:
\begin{equation}
{\bf x}^2=\sum_l {\bf x}_l {\bf x}_l = \sum_{j,k}(\delta_{j,k} +
2 \eta_{j,k}) {\bf X}_j {\bf X}_k 
\end{equation}
where $\eta_{j,k}={1\over 2} ( u_{j,k} + u_{k,j} + \sum_l u_{l,j}u_{l,k})$ 
are the so called Langrangian strains which are always symmetric.
$\epsilon_{j,k}$ do not coincide with the Lagrangian strains but
differ only for terms quadratic in $u_{i,j}$. 

At first order in $\epsilon_{j,k}$ we have
the following useful relations for the reciprocal lattice vectors:
\begin{equation}
{\bf b}'_{j,i} = {\bf b}_{j,i} -  \sum_{k=1}^3 \epsilon_{j,k} {\bf b}_{k,i},
\end{equation}
and for the unit cell volume:
\begin{equation}
\Omega'=\Omega \left( 1+\sum_{i=1}^3 \epsilon_{i,i} \right).
\end{equation}

In general, a strain changes both the size 
and the shape of the unit cell and might change the Bravais lattice. \\
In this section we consider some strains of interest for our applications: 
\begin{equation}
\epsilon_A=\left( \begin{array}{ccc}
\epsilon_{1,1}, & 0, & 0 
\\
0,& \epsilon_{1,1}, & 0 
\\
0,& 0, & \epsilon_{1,1}
\end{array}
\right),
\end{equation}
is an isotropic strain that modifies the $x$, $y$, and $z$ directions in the
same way,
\begin{equation}
\epsilon_B=\left( \begin{array}{ccc}
\epsilon_{1,1},& 0, & 0 
\\
0, & \epsilon_{1,1}, &  0 
\\
0, & 0, &  0
\end{array}
\right),
\epsilon_{B'}=\left( \begin{array}{ccc}
\epsilon_{1,1},& 0, & 0 
\\
0, & 0, &  0
\\
0, & 0, & \epsilon_{1,1}
\end{array}
\right),
\epsilon_{B''}=\left( \begin{array}{ccc}
0, & 0, & 0 
\\
0, & \epsilon_{2,2}, &  0
\\
0, & 0, & \epsilon_{2,2}
\end{array}
\right),
\end{equation}
are three strains that modify the $xy$, $xz$, and $yz$ plane 
isotropically, without changing the other direction.
The following three strains modify the length in one direction, 
$x$, $y$, or $z$, so they are compressions or dilatations in these directions:
\begin{equation}
\epsilon_C=\left( \begin{array}{ccc}
\epsilon_{1,1}, & 0, & 0 
\\
0, & 0, & 0 
\\
0, & 0, & 0
\end{array}
\right),
\end{equation}

\begin{equation}
\epsilon_D=\left( \begin{array}{ccc}
0, & 0, & 0 
\\
0, &  \epsilon_{2,2}, & 0 
\\
0, & 0, & 0
\end{array}
\right),
\end{equation}

\begin{equation}
\epsilon_E=\left( \begin{array}{ccc}
0, & 0, & 0 
\\
0, & 0, & 0 
\\
0, & 0, & \epsilon_{3,3}
\end{array}
\right).
\end{equation}
Then we consider shear strains first in all three directions:
\begin{equation}
\epsilon_F=\left( \begin{array}{ccc}
0, & \epsilon_{1,2}, & \epsilon_{1,2}
\\
\epsilon_{1,2}, & 0, & \epsilon_{1,2} 
\\
\epsilon_{1,2}, & \epsilon_{1,2}, & 0
\end{array}
\right),
\end{equation}
with the possibility to apply a different sign in one direction
\begin{equation}
\epsilon_{F'}=\left( \begin{array}{ccc}
0, & -\epsilon_{1,2}, & \epsilon_{1,2}
\\
-\epsilon_{1,2}, & 0, & \epsilon_{1,2} 
\\
\epsilon_{1,2}, & \epsilon_{1,2}, & 0
\end{array}
\right),
\epsilon_{F''}=\left( \begin{array}{ccc}
0, & \epsilon_{1,2}, & -\epsilon_{1,2}
\\
\epsilon_{1,2}, & 0, & \epsilon_{1,2} 
\\
-\epsilon_{1,2}, & \epsilon_{1,2}, & 0
\end{array}
\right),
\epsilon_{F'''}=\left( \begin{array}{ccc}
0, & \epsilon_{1,2}, & \epsilon_{1,2}
\\
\epsilon_{1,2}, & 0, & -\epsilon_{1,2} 
\\
\epsilon_{1,2}, & -\epsilon_{1,2}, & 0
\end{array}
\right),
\end{equation}
then only in the $xy$ plane:
\begin{equation}
\epsilon_G=\left( \begin{array}{ccc}
0, & \epsilon_{1,2}, & 0
\\
\epsilon_{1,2}, & 0, & 0
\\
0, & 0, & 0
\end{array}
\right),
\end{equation}
in the $xz$ plane:
\begin{equation}
\epsilon_H=\left( \begin{array}{ccc}
0, & 0, & \epsilon_{1,3}
\\
0, & 0, & 0
\\
\epsilon_{1,3}, & 0, & 0
\end{array}
\right),
\end{equation}
and finally in the $yz$ plane:
\begin{equation}
\epsilon_I=\left( \begin{array}{ccc}
0, & 0, & 0
\\
0, & 0, & \epsilon_{2,3} 
\\
0, & \epsilon_{2,3}, & 0
\end{array}
\right).
\end{equation}
A generic strain in the $xy$ plane is
\begin{equation}
\epsilon_L=\left( \begin{array}{ccc}
\epsilon_{1,1}, & \epsilon_{1,2}, & 0 
\\
\epsilon_{2,1}, & \epsilon_{2,2}, & 0 
\\
0, & 0, & 0
\end{array}
\right).
\end{equation}
For some lattices it is also of interest to apply
\begin{equation}
\epsilon_M=\left( \begin{array}{ccc}
\epsilon_{1,1}, & 0, & 0 
\\
0, & \epsilon_{1,1}, & 0 
\\
0, & 0, & \epsilon_{3,3}
\end{array}
\right),
\end{equation}
a strain that modifies isotropically the plane $xy$ and also the $z$ direction.
\begin{equation}
\epsilon_N=\left( \begin{array}{ccc}
\epsilon_{1,1}, & 0, & 0 
\\
0, & -\epsilon_{1,1}, & 0 
\\
0, & 0, & 0
\end{array}
\right),
\end{equation}
is a shear strain that elongates (or compresses) the $x$ direction and
compresses (or elongates) of the same amount the $y$ direction.
We can define similar strains for the $x$ and $z$ and for 
the $y$ and $z$ directions.
\begin{equation}
\epsilon_O=\left( \begin{array}{ccc}
\epsilon_{1,1}, & 0, & 0 
\\
0, & 0, & 0 
\\
0, & 0, & -\epsilon_{1,1}
\end{array}
\right),
\end{equation}

\begin{equation}
\epsilon_P=\left( \begin{array}{ccc}
0, & 0, & 0 
\\
0, & \epsilon_{2,2}, & 0 
\\
0, & 0, & -\epsilon_{2,2}
\end{array}
\right).
\end{equation}

The strain is a symmetric tensors. Introducing the Voigt notation 
$\epsilon_1=\epsilon_{1,1}$,
$\epsilon_2=\epsilon_{2,2}$, $\epsilon_3=\epsilon_{3,3}$, but
$\epsilon_4=2 \epsilon_{2,3}$, $\epsilon_5=2 \epsilon_{1,3}$, and
$\epsilon_6=2 \epsilon_{1,2}$, a generic strain is:
\begin{equation}
\epsilon=\left( \begin{array}{ccc}
\epsilon_1, & \epsilon_6/2, & \epsilon_5/2 
\\
\epsilon_6/2, & \epsilon_2, & \epsilon_4/2  
\\
\epsilon_5/2, & \epsilon_4/2, & \epsilon_{3}
\end{array}
\right).
\end{equation}

For each system (with the exception of the monoclinic and triclinic) 
we discuss how the Bravais lattice changes for a given strain limiting
to the strains of interest for the following.

{\color{web-blue}\subsection{Cubic system}}
\color{black}

The cell remains cubic only applying an isotropic strain $\epsilon_A$ that 
changes the cubic lattice constant $a_c$ to $a=(1+\epsilon_{1,1})a_c$.

Applying $\epsilon_B$, the (body-centered) cubic
unit cell becomes (centered) tetragonal with:
\begin{eqnarray}
a&=&a_c (1+\epsilon_{1,1}), \\
c&=&a_c.
\end{eqnarray}
The face-centered cubic lattice becomes a centered tetragonal lattice with
\begin{eqnarray}
a&=&a_c {\sqrt{2} \over 2} (1+\epsilon_{1,1}), \\
c&=&a_c.
\end{eqnarray}
However the Cartesian reference system of the tetragonal cell
is rotated with respect to that of the face-centered cubic cell. 
A point of Cartesian coordinates ${\bf r}=(x_1,x_2,x_3)$ 
in the reference system of the face-centered cubic cell 
has coordinates 
${\bf r}=(X_1,X_2,X_3)$ in the reference system of the centered tetragonal cell
where $X_i=\sum_j R^A_{i,j} x_j$ and the rotation matrix $R_{i,j}$ is 
\begin{equation}
R^A=\left( \begin{array}{ccc}
1/\sqrt{2}, & -1/\sqrt{2}, & 0 
\\
1/\sqrt{2}, & 1/\sqrt{2}, & 0 
\\
0, & 0, & 1
\end{array}
\right).
\end{equation}

Similarly, by applying $\epsilon_E$ the (body-centered) cubic
cell becomes a (centered) tetragonal cell with
\begin{eqnarray}
a&=&a_c,   \\
c&=&a_c (1+\epsilon_{3,3}).
\end{eqnarray}
The face-centered cubic lattice becomes a centered tetragonal lattice with
\begin{eqnarray}
a&=&a_c {\sqrt{2}\over 2},   \\
c&=&a_c (1+\epsilon_{3,3}).
\end{eqnarray}
The reference system of the centered tetragonal
cell is rotated with respect to the reference system of the face-centered
cubic cell and the change of coordinates can be done with the same rotation 
matrix written above.

Among the shear strain $\epsilon_F$
transforms the cubic unit cell into a rhombohedral cell with
parameters:
\begin{eqnarray}
a_r&=& a_c \sqrt{1+2\epsilon_{1,2}^2}, \\
\cos\alpha &=& {\epsilon_{1,2} (\epsilon_{1,2} + 2) \over 
1 + 2 \epsilon_{1,2}^2 }.
\end{eqnarray}
The reference system of the rhombohedral cell is rotated with respect to
the reference system of the cubic cell. The change of coordinates can
be written as above with the rotation matrix:
\begin{equation}
R^B=\left( \begin{array}{ccc}
1/\sqrt{2}, & 0, & -1/\sqrt{2}
\\
-1/\sqrt{6}, & 2/\sqrt{6}, & -1/\sqrt{6}
\\
1/\sqrt{3}, & 1/\sqrt{3}, & 1/\sqrt{3}
\end{array}
\right).
\end{equation}

The face-centered cubic cell is transformed by $\epsilon_{F'''}$
in a rhombohedral unit cell with parameters:
\begin{eqnarray}
a_r&=& {a_c \over 2} \sqrt{6 \epsilon_{1,2}^2-4 \epsilon_{1,2} +2}, \\
\cos\alpha &=& {5\epsilon_{1,2}^2- 6\epsilon_{1,2} + 1 \over 
6\epsilon_{1,2}^2 - 4\epsilon_{1,2}+2 },
\end{eqnarray}
The reference system of the rhombohedral cell is rotated with respect to
the reference system of the face-centered cubic cell. 
The change of coordinates can be written as above with the rotation matrix:
\begin{equation}
R^C=\left( \begin{array}{ccc}
1/\sqrt{2}, & 1/\sqrt{2}, & 0 \\
-1/\sqrt{6}, & 1/\sqrt{6}, & -2/\sqrt{6}
\\
-1/\sqrt{3}, & 1/\sqrt{3}, & 1/\sqrt{3}
\end{array}
\right).
\end{equation}

The body-centered cubic cell is transformed by 
$\epsilon_{F'''}$ in a rhombohedral unit cell
with parameters:
\begin{eqnarray}
a_r&=& {a_c \over 2} \sqrt{ 4\epsilon_{1,2}^2 + 4\epsilon_{1,2} + 3 }, \\
\cos\alpha &=& -{4\epsilon_{1,2}+1 \over 4\epsilon_{1,2}^2+4\epsilon_{1,2}+3}.
\end{eqnarray}
The reference system of the rhombohedral cell is rotated with respect to
the reference system of the body-centered cubic cell. 
The change of coordinates can be written as above with the rotation matrix 
$R^C$.

{\color{web-blue}\subsection{Tetragonal system}}
\color{black}

Applying $\epsilon_A$, or $\epsilon_B$, or $\epsilon_E$ to a 
(centered) tetragonal cell
does not change its shape. $\epsilon_A$ changes $a_t$ into 
$a_t(1+\epsilon_{1,1})$ and $c_t$ into $c_t(1+\epsilon_{1,1})$ so that the
ration $c_t/a_t$ remains constant. 
$\epsilon_B$ changes $a_t$ into $a_t(1+\epsilon_{1,1})$
while $c_t$ does not change and $\epsilon_E$ changes  
$c_t$ into $c_t(1+\epsilon_{3,3})$ while $a_t$ does not change.

Applying $\epsilon_{B'}$ to a tetragonal cell transforms it into an  
orthorhombic cell with
\begin{eqnarray}
a&=& a_t (1+\epsilon_{1,1}), \\
b&=& a_t, \\
c&=& c_t (1+\epsilon_{1,1}).
\end{eqnarray}
Applying $\epsilon_{B'}$ to a centered tetragonal cell transforms it
into a body-centered orthorhombic cell with the same
parameters. 

Similarly, applying $\epsilon_C$ to a tetragonal cell transforms 
it into an  orthorhombic cell with
\begin{eqnarray}
a&=&a_t (1+\epsilon_{1,1}), \\
b&=&a_t, \\
c&=&c_t,
\end{eqnarray}
and applying $\epsilon_C$ to a centered tetragonal cell transforms it
into a body-centered orthorhombic cell with the same
parameters.\\

$\epsilon_G$ applied to the tetragonal cell transforms it into a 
base-centered orthorhombic cell, with parameters:
\begin{eqnarray}
a&=&\sqrt{2} a_t (1-\epsilon_{1,2}), \\
b&=&\sqrt{2} a_t (1+\epsilon_{1,2}) , \\
c&=&c_t.
\end{eqnarray}
The reference system of the orthorhombic cell is rotated with respect to
the reference system of the tetragonal cell. 
The change of coordinates can be written as above with the rotation matrix 
$R^A$.
$\epsilon_G$ applied to the centered tetragonal cell transforms it into
a face-centered orthorhombic cell with the same parameters written above
and the same change of reference system.

$\epsilon_H$ applied to the tetragonal cell transforms it into a 
monoclinic (b-unique) cell with:
\begin{eqnarray}
a&=&a_t \sqrt{1+\epsilon_{1,3}^2}, \\
b&=&a_t, \\
c&=&c_t \sqrt{1+\epsilon_{1,3}^2}, \\
\cos\beta &=& {2 \epsilon_{1,3} \over 1 + \epsilon_{1,3}^2}.
\end{eqnarray}
The reference system of the monoclinic cell is rotated with respect to
the reference system of the tetragonal cell. 
The change of coordinates can be written as above with the rotation matrix 
\begin{equation}
R^D=\left( \begin{array}{ccc}
\cos\phi, & 0, & -\sin\phi \\
0, & 1, & 0 \\
\sin\phi, & 0, & \cos\phi  
\end{array}
\right)
\end{equation}
where $\tan \phi=-\epsilon_{1,3}$.

Applying $\epsilon_H$ transforms the centered tetragonal cell into 
a base-centered $b$-unique monoclinic cell with
\begin{eqnarray}
a&=&\sqrt{(a_t^2+c_t^2)(1+\epsilon_{1,3}^2)-4\epsilon_{1,3}a_tc_t}, \\
b&=&a_t, \\
c&=&a_t \sqrt{1+\epsilon_{1,3}^2}, \\
\cos\beta &=& {a_t (1+\epsilon_{1,3}^2) -2 \epsilon_{1,3} c_t \over 
\sqrt{(a_t^2+c_t^2)(1+\epsilon_{1,3}^2)-4\epsilon_{1,3}a_tc_t} 
\sqrt{(1+\epsilon_{1,3}^2)}}.
\end{eqnarray}
The reference system of the base-centered monoclinic cell is rotated with 
respect to the reference system of the centered tetragonal cell. 
The change of coordinates can be written as above with the rotation matrix 
$R^D$ and the angle $\phi$ equal to
\begin{equation}
{\rm tg} \phi = -{\epsilon_{1,3} a_t - c_t \over a_t - \epsilon_{3,1} c_t}.
\end{equation}

{\color{web-blue}\subsection{Orthorhombic system}}
\color{black}

Applying $\epsilon_A$, $\epsilon_B$, $\epsilon_{B'}$, $\epsilon_{B''}$, 
$\epsilon_C$, $\epsilon_D$, or $\epsilon_E$, to a (base-centered, 
face-centered, or body-centered) orthorhombic cell does not change its shape. 
$\epsilon_A$ changes $a_o$ into $a_o(1+\epsilon_{1,1})$, $b_o$ into
$b_o(1+\epsilon_{1,1})$ and $c_o$ into $c_o(1+\epsilon_{1,1})$.
$\epsilon_B$ changes $a_o$ into $a_o(1+\epsilon_{1,1})$ and $b_o$ into
$b_o(1+\epsilon_{1,1})$ while $c_o$ remains constant.
$\epsilon_{B'}$ changes $a_o$ into $a_o(1+\epsilon_{1,1})$ and $c_o$ into
$c_o(1+\epsilon_{1,1})$ while $b_o$ remains constant.
$\epsilon_{B''}$ changes $b_o$ into $b_o(1+\epsilon_{1,1})$ and $c_o$ into
$c_o(1+\epsilon_{1,1})$ while $a_o$ remains constant.
$\epsilon_C$ changes $a_o$ into 
$a_o(1+\epsilon_{1,1})$, while $b_o$ and $c_o$ remain constant.
$\epsilon_D$ changes $b_o$ into $b_o(1+\epsilon_{2,2})$ while
$a_o$ and $c_o$ remain constant.
$\epsilon_E$ changes $c_o$ into $c_o(1+\epsilon_{3,3})$ while $a_o$ and
$b_o$ remain constant.

Applying $\epsilon_G$ to an orthorhombic cell transforms it into a 
monoclinic ($c$-unique) cell with
\begin{eqnarray}
a&=&a_o \sqrt{1+\epsilon_{1,2}^2}, \\
b&=&b_o \sqrt{1+\epsilon_{1,2}^2}, \\
c&=&c_o, \\
\cos\gamma &=& {2 \epsilon_{1,2} \over 1 + \epsilon_{1,2}^2}.
\end{eqnarray}
The reference system of the monoclinic cell is rotated with respect to
the reference system of the orthorhombic cell. 
The change of coordinates can be written as above with the rotation matrix 
\begin{equation}
R^E=\left( \begin{array}{ccc}
\cos\phi, & -\sin\phi, & 0 \\
\sin\phi, &  \cos\phi, & 0 \\
0, & 0, & 1 \\
\end{array}
\right),
\end{equation}
where $\tan \phi=-\epsilon_{1,2}$.

Similarly, applying $\epsilon_H$ to a (base-centered) 
orthorhombic lattice transforms
it in a (base-centered) monoclinic lattice ($b$-unique) with 
\begin{eqnarray}
a&=&a_o \sqrt{1+\epsilon_{1,3}^2}, \\
b&=&b_o, \\
c&=&c_o \sqrt{1+\epsilon_{1,3}^2}, \\
\cos\beta &=& {2 \epsilon_{1,3} \over 1 + \epsilon_{1,3}^2}. 
\end{eqnarray}
The reference system of the (base-centered) monoclinic cell is 
rotated with respect to the reference system of the (base-centered) 
orthorhombic cell. 
The change of coordinates can be written as above with the rotation matrix 
$R^D$ and $\tan \phi=-\epsilon_{1,3}$.

$\epsilon_I$ transforms the (base-centered) orthorhombic lattice 
in a (base-centered) monoclinic lattice that 
however is $a$-unique and must be rotated to be simulated.
For instance we can simulate the strained orthorhombic cell with a monoclinic
$c$-unique lattice with
\begin{eqnarray}
a&=&b_o \sqrt{1+\epsilon_{2,3}^2}, \\
b&=&c_o \sqrt{1+\epsilon_{2,3}^2}, \\
c&=&a_o, \\
\cos\gamma &=& {2 \epsilon_{2,3} \over 1 + \epsilon_{2,3}^2}. 
\end{eqnarray}
The reference system of the (base-centered) monoclinic cell is 
rotated with respect to
the reference system of the (base-centered) orthorhombic cell. 
The change of coordinates can be written as above with the rotation matrix 
\begin{equation}
R^F=\left( \begin{array}{ccc}
0, & \cos \phi, &  -\sin \phi
\\
0, & \sin \phi, & \cos \phi 
\\
1, & 0, & 0
\end{array}
\right),
\end{equation}
and ${\rm tg} \phi =-\epsilon_{2,3}$. 

The application of $\epsilon_G$ to a base-centered orthorhombic lattice
transforms it into a $c$-unique monoclinic lattice with parameters:
\begin{eqnarray}
a&=&a_o \sqrt{1+\epsilon_{1,2}^2}, \\
b&=&{1\over 2} \sqrt{(a_o^2+b_o^2)(1+\epsilon_{1,2}^2)+4a_ob_o\epsilon_{1,2}}, \\
c&=&c_o,  \\
\cos\gamma &=& {a_o (1+\epsilon_{1,2}^2)+2a_ob_o\epsilon_{1,2} \over
\sqrt{1+\epsilon_{1,2}^2} \sqrt{(a_o^2+b_o^2)
(1+\epsilon_{1,2}^2)+4a_ob_o\epsilon_{1,2}}}. 
\end{eqnarray}
The reference system of the monoclinic cell is rotated with respect to
the reference system of the orthorhombic cell. 
The change of coordinates can be written as above with the rotation matrix 
$R^E$ and ${\rm tg}\phi=-\epsilon_{1,2}$.

The application of $\epsilon_G$ to a face-centered orthorhombic lattice
transforms it into a $c$-unique base-centered monoclinic lattice with 
parameters:
\begin{eqnarray}
a&=&a_o \sqrt{1+\epsilon_{1,2}^2}, \\
b&=&{1\over 2} \sqrt{(a_o^2+b_o^2)(1+\epsilon_{1,2}^2)+4a_ob_o\epsilon_{1,2}}, \\
c&=&c_o,  \\
\cos\gamma &=& {a_o (1+\epsilon_{1,2}^2)+2a_ob_o\epsilon_{1,2} \over
\sqrt{1+\epsilon_{1,2}^2} \sqrt{(a_o^2+b_o^2)
(1+\epsilon_{1,2}^2)+4a_ob_o\epsilon_{1,2}}}. 
\end{eqnarray}
The reference system of the base-centered monoclinic cell is rotated 
with respect to the reference system of the face-centered orthorhombic cell. 
The change of coordinates can be written as above with the rotation matrix 
$R^E$ and ${\rm tg}\phi=-\epsilon_{1,2}$.

The application of $\epsilon_H$ to a face-centered orthorhombic lattice
transforms it into a $b$-unique base-centered monoclinic lattice with
parameters:
\begin{eqnarray}
a&=&a_o \sqrt{1+\epsilon_{1,3}^2}, \\
b&=&b_o,  \\
c&=&{1\over 2} \sqrt{(a_o^2+c_o^2)(1+\epsilon_{1,3}^2)+4a_oc_o\epsilon_{1,3}}, \\
\cos\gamma &=& {a_o (1+\epsilon_{1,3}^2)+2a_oc_o\epsilon_{1,3} \over
\sqrt{1+\epsilon_{1,3}^2} \sqrt{(a_o^2+c_o^2)
(1+\epsilon_{1,3}^2)+4a_oc_o\epsilon_{1,3}}}. 
\end{eqnarray}
The reference system of the base-centered monoclinic cell is rotated 
with respect to the reference system of the face-centered orthorhombic cell. 
The change of coordinates can be written as above with the rotation matrix 
$R^D$ and ${\rm tg}\phi=-\epsilon_{1,3}$.

The application of $\epsilon_I$ to a face-centered orthorhombic lattice
transforms it into a base-centered monoclinic lattice that however is 
$a$-unique, so we have to rotate it. For instance we can transform it
in a base-centered $c$-unique monoclinic lattice with parameters:
\begin{eqnarray}
a&=&b_o \sqrt{1+\epsilon_{2,3}^2}, \\
b&=&{1\over 2} \sqrt{(b_o^2+c_o^2)(1+\epsilon_{2,3}^2)+4b_oc_o
\epsilon_{2,3}}, \\
c&=&a_o,  \\
\cos\gamma &=& {b_o^2 (1+\epsilon_{2,3}^2)+2b_oc_o\epsilon_{2,3} \over
\sqrt{1+\epsilon_{2,3}^2} \sqrt{(b_o^2+c_o^2)
(1+\epsilon_{2,3}^2)+4b_oc_o\epsilon_{2,3}}}. 
\end{eqnarray}
The reference system of the base-centered monoclinic cell is rotated 
with respect to the reference system of the face-centered orthorhombic cell. 
The change of coordinates can be written as above with the rotation matrix 
$R^F$ and 
${\rm tg}\phi=-\epsilon_{2,3}$.

The application of $\epsilon_G$ to a body-centered orthorhombic lattice
transforms it into a base-centered $c$-unique monoclinic lattice with 
parameters:
\begin{eqnarray}
a&=&\sqrt{(a_o^2+b_o^2)(1+\epsilon_{1,2}^2)-4a_ob_o\epsilon_{1,2}}, \\
a&=&a_o \sqrt{1+\epsilon_{1,2}^2}, \\
c&=&c_o,  \\
\cos\gamma &=& {a_o (1+\epsilon_{1,2}^2)-2a_ob_o\epsilon_{1,2} \over
\sqrt{1+\epsilon_{1,2}^2} \sqrt{(a_o^2+b_o^2)
(1+\epsilon_{1,2}^2)-4a_ob_o\epsilon_{1,2}}}, 
\end{eqnarray}
The reference system of the base-centered monoclinic cell is rotated 
with respect to the reference system of the body-centered orthorhombic cell. 
The change of coordinates can be written as above with the rotation matrix 
$R^E$ and
\begin{equation}
{\rm tg} \phi = -{ \epsilon a_o - b_o \over a_o - \epsilon b_o }.
\end{equation}

The application of a strain $\epsilon_H$ to a body-centered orthorhombic
lattice transforms it into a base-centered $b$-unique monoclinic lattice 
\begin{eqnarray}
a&=&\sqrt{(a_o^2+c_o^2)(1+\epsilon_{1,3}^2)-4\epsilon_{1,3}a_oc_o}, \\
b&=&b_o, \\
c&=&a_o \sqrt{1+\epsilon_{1,3}^2}, \\
\cos\beta &=& {a_o (1+\epsilon_{1,3}^2) -2 \epsilon_{1,3} c_o \over 
\sqrt{(a_o^2+c_o^2)(1+\epsilon_{1,3}^2)-4\epsilon_{1,3}a_oc_o} 
\sqrt{(1+\epsilon_{1,3}^2)}}.
\end{eqnarray}
The reference system of the base-centered monoclinic cell is rotated 
with respect to the reference system of the body-centered orthorhombic cell. 
The change of coordinates can be written as above with the rotation matrix 
$R^D$ and
\begin{equation}
{\rm tg} \phi = -{\epsilon_{1,3} a_o - c_o \over a_o - \epsilon_{3,1} c_o}.
\end{equation}

The application of a strain $\epsilon_I$ to a body-centered orthorhombic
lattice transforms it into a base-centered monoclinic lattice that however
is $a$-unique. In order to simulate it we must rotate it so that it
becomes for instance a base-centered $c$-unique monoclinic lattice with
parameters
\begin{eqnarray}
a&=&\sqrt{(b_o^2+c_o^2)(1+\epsilon_{2,3}^2)-4\epsilon_{2,3}b_oc_o}, \\
b&=&b_o \sqrt{1+\epsilon_{2,3}^2}, \\
c&=&a_o \\
\cos\gamma &=& {b_o (1+\epsilon_{2,3}^2) -2 \epsilon_{2,3} c_o \over 
\sqrt{(b_o^2+c_o^2)(1+\epsilon_{2,3}^2)-4\epsilon_{2,3}b_oc_o} 
\sqrt{(1+\epsilon_{2,3}^2)}}.
\end{eqnarray}
The reference system of the base-centered monoclinic cell is rotated 
with respect to the reference system of the body-centered orthorhombic cell. 
The change of coordinates can be written as above with the rotation matrix 
$R^F$ and
and 
\begin{equation}
{\rm tg} \phi = -{\epsilon_{2,3} b_o - c_o \over b_o - \epsilon_{3,2} c_o}.
\end{equation}

{\color{web-blue}\subsection{Monoclinic system}}
\color{black}

Applying $\epsilon_A$, $\epsilon_C$, $\epsilon_D$, $\epsilon_E$, or
$\epsilon_G$ to a $c$-unique (base-centered) monoclinic cell does 
not change its shape.

Applying $\epsilon_A$ to a $c$-unique (base-centered) monoclinic 
lattice changes
$a_m$ to $a_m(1+\epsilon_{1,1})$, $b_m$ to $b_m(1+\epsilon_{1,1})$
and $c_m$ to $c_m(1+\epsilon_{1,1})$ while $\cos \gamma_m$
does not change.

Applying $\epsilon_C$ to a $c$-unique (base-centered) monoclinic lattice 
changes $a_m$, $b_m$, $c_m$, and $\cos \gamma_m$ to 
\begin{eqnarray}
a&=&a_m(1+\epsilon_{1,1}), \\
b&=&b_m \sqrt{1+2 \epsilon_{1,1}\cos^2\gamma_m
+\epsilon_{1,1}^2 \cos^2\gamma_m}, \\
c&=&c_m \\
\cos\gamma &=& {(1+\epsilon_{1,1}) \cos\gamma_m \over 
\sqrt{1+2 \epsilon_{1,1}\cos^2\gamma_m
+\epsilon_{1,1}^2 \cos^2\gamma_m}},
\end{eqnarray}

Applying $\epsilon_D$ to a $c$-unique (base-centered) monoclinic lattice 
changes $a_m$, $b_m$, $c_m$, and $\cos \gamma_m$ to 
\begin{eqnarray}
a&=&a_m, \\
b&=&b_m \sqrt{1+2 \epsilon_{2,2}\sin^2\gamma_m
+\epsilon_{2,2}^2 \sin^2\gamma_m}, \\
c&=&c_m \\
\cos\gamma &=& {\cos\gamma_m \over 
\sqrt{1+2 \epsilon_{2,2}\sin^2\gamma_m
+\epsilon_{2,2}^2 \sin^2\gamma_m}}.
\end{eqnarray}

Applying $\epsilon_E$ to a $c$-unique (base-centered) monoclinic 
lattice changes
only $c_m$ to $c_m(1+\epsilon_{3,3})$ while all the other crystal
parameter do not change.

Applying $\epsilon_G$ to a $c$-unique (base-centered) monoclinic lattice 
changes $a_m$, $b_m$, $c_m$, and $\cos \gamma_m$ to 
\begin{eqnarray}
a&=&a_m \sqrt{1+\epsilon_{1,2}^2}, \\
b&=&b_m \sqrt{1+\epsilon_{1,2}^2
+4\epsilon_{1,2} \cos\gamma_m \sin\gamma_m}, \\
c&=&c_m, \\
\cos\gamma &=& {\cos\gamma_m (1+\epsilon_{1,2}^2) + 2 \epsilon_{1,2} 
\sin \gamma_m \over \sqrt{1+\epsilon_{1,2}^2}
\sqrt{1+\epsilon_{1,2}^2+4\epsilon_{1,2} \cos\gamma_m \sin\gamma_m}}.
\end{eqnarray}
The reference system of the strained (base-centered) monoclinic 
lattice is rotated 
with respect to the reference system of the unstrained  
(base-centered) monoclinic lattice. 
The change of coordinates can be written as above with the rotation matrix 
$R^E$ and ${\rm tg}\phi=-\epsilon_{1,2}$.

Applying $\epsilon_H$ to a $c$-unique monoclinic lattice transforms
it into a triclinic cell with parameters:
\begin{eqnarray}
a&=&a_m \sqrt{1+\epsilon_{1,3}^2}, \\
b&=&b_m \sqrt{1+\epsilon_{1,3}^2 \cos^2\gamma_m}, \\
c&=&c_m \sqrt{1+\epsilon_{1,3}^2}, \\
\cos\alpha &=& {2 \epsilon_{1,3} \cos\gamma_m \over 
\sqrt{1+\epsilon_{1,3}^2} \sqrt{1+\epsilon_{1,3}^2 \cos^2\gamma_m}}, \\
\cos\beta &=& {2 \epsilon_{1,3}^2 \over 1+\epsilon_{1,3}^2}, \\
\cos\gamma &=& {\cos\gamma_m \sqrt{1+\epsilon_{1,3}^2} \over
\sqrt{1+\epsilon_{1,3}^2 \cos^2\gamma_m}}.
\end{eqnarray}
The reference system of the triclinic lattice is rotated 
with respect to the reference system of the  
monoclinic lattice. 
The change of coordinates can be written as above with the rotation matrix 
$R^D$ and ${\rm tg}\phi=-\epsilon_{1,3}$.

Applying $\epsilon_I$ to a $c$-unique monoclinic lattice transforms
it into a triclinic cell with parameters:
\begin{eqnarray}
a&=&a_m,  \\
b&=&b_m \sqrt{1+\epsilon_{2,3}^2 \sin^2\gamma_m}, \\
c&=&c_m \sqrt{1+\epsilon_{2,3}^2}, \\
\cos\alpha &=& {2 \epsilon_{2,3} \sin\gamma_m \over 
\sqrt{1+\epsilon_{2,3}^2} \sqrt{1+\epsilon_{2,3}^2 \sin^2\gamma_m}}, \\
\cos\beta &=& 0, \\
\cos\gamma &=& { \cos\gamma_m  \over
\sqrt{1+\epsilon_{2,3}^2 \sin^2\gamma_m}}.
\end{eqnarray}
The reference system of the triclinic lattice is rotated 
with respect to the reference system of the  
monoclinic lattice. 
The change of coordinates can be written as above with the rotation matrix 
\begin{equation}
R^G=\left( \begin{array}{ccc}
1, & 0, & 0 \\
0, & \cos \phi, &  -\sin \phi
\\
0, & \sin \phi, & \cos \phi 
\end{array}
\right),
\end{equation}
where  ${\rm tg}\phi=-\epsilon_{2,3}$.

Applying $\epsilon_H$ to a $c$-unique base-centered monoclinic lattice 
transforms it into a triclinic lattice with parameters:
\begin{eqnarray}
a&=&a_m \sqrt{1+\epsilon_{1,3}^2}, \\
b&=&b_m \sqrt{1+\epsilon_{1,3}^2 \cos^2\gamma_m}, \\
c&=&{1\over 2} \sqrt{(a_m^2+c_m^2)(1+\epsilon_{1,3}^2)+4\epsilon_{1,3}a_mc_m},\\
\cos\alpha &=& {\cos\gamma_m (a_m (1+\epsilon_{1,3}^2)+2\epsilon_{1,3}c_m) 
\over 
\sqrt{1+\epsilon_{1,3}^2 \cos^2\gamma_m} \sqrt{(a_m^2+c_m^2)(1+\epsilon_{1,3}^2)+4\epsilon_{1,3}a_mc_m}}, \\
\cos\beta &=& {a_m (1+\epsilon_{1,3}^2)+2\epsilon_{1,3}c_m 
\over 
\sqrt{1+\epsilon_{1,3}^2} \sqrt{(a_m^2+c_m^2)(1+\epsilon_{1,3}^2)+4\epsilon_{1,3}a_mc_m}}, \\
\cos\gamma &=& {\cos\gamma_m \sqrt{1+\epsilon_{1,3}^2} \over
\sqrt{1+\epsilon_{1,3}^2 \cos^2\gamma_m}}.
\end{eqnarray}
The reference system of the triclinic lattice is rotated 
with respect to the reference system of the base-centered
monoclinic lattice. 
The change of coordinates can be written as above with the rotation matrix 
$R^D$ and ${\rm tg}\phi=-\epsilon_{1,3}$.

Applying $\epsilon_I$ to a $c$-unique base-centered monoclinic lattice 
transforms it into a triclinic lattice with parameters:
\begin{eqnarray}
a&=&a_m, \\
b&=&b_m \sqrt{1+\epsilon_{2,3}^2 \sin^2\gamma_m}, \\
c&=&{1\over 2} \sqrt{a_m^2+c_m^2(1+\epsilon_{2,3}^2)},\\
\cos\alpha &=& {a_m\cos\gamma_m +2\epsilon_{2,3}c_m \sin \gamma_m 
\over 
\sqrt{1+\epsilon_{2,3}^2 \sin^2\gamma_m} 
\sqrt{a_m^2+c_m^2(1+\epsilon_{2,3}^2)}}, \\
\cos\beta &=& {a_m  
\over 
\sqrt{a_m^2+c_m^2(1+\epsilon_{2,3}^2)}}, \\
\cos\gamma &=& {\cos\gamma_m \over
\sqrt{1+\epsilon_{2,3}^2 \sin^2\gamma_m}}.
\end{eqnarray}
The reference system of the triclinic lattice is rotated 
with respect to the reference system of the base-centered
monoclinic lattice. 
The change of coordinates can be written as above with the rotation matrix 
$R^G$ and ${\rm tg}\phi=-\epsilon_{2,3}$.

Applying $\epsilon_A$, $\epsilon_C$, $\epsilon_D$, $\epsilon_E$, and
$\epsilon_H$ to a $b$-unique (base-centered) monoclinic lattice
does not change its shape.

Applying $\epsilon_A$ to a $b$-unique (base-centered) monoclinic 
lattice changes
$a_m$ to $a_m(1+\epsilon_{1,1})$, $b_m$ to $b_m(1+\epsilon_{1,1})$
and $c_m$ to $c_m(1+\epsilon_{1,1})$ while $\cos \beta_m$
does not change.

Applying $\epsilon_C$ to a $b$-unique (base-centered) monoclinic lattice 
changes $a_m$, $b_m$, $c_m$, and $\cos \beta_m$ to 
\begin{eqnarray}
a&=&a_m(1+\epsilon_{1,1}), \\
b&=&b_m \\
c&=&c_m \sqrt{1+2 \epsilon_{1,1}\cos^2\beta_m
+\epsilon_{1,1}^2 \cos^2\beta_m}, \\
\cos\beta &=& {(1+\epsilon_{1,1}) \cos\beta_m \over 
\sqrt{1+2 \epsilon_{1,1}\cos^2\beta_m
+\epsilon_{1,1}^2 \cos^2\beta_m}},
\end{eqnarray}

Applying $\epsilon_D$ to a $b$-unique (base-centered) monoclinic 
lattice changes
only $b_m$ to $b_m(1+\epsilon_{2,2})$ while all the other crystal
parameter do not change.

Applying $\epsilon_E$ to a $b$-unique (base-centered) monoclinic lattice 
changes $a_m$, $b_m$, $c_m$, and $\cos \beta_m$ to 
\begin{eqnarray}
a&=&a_m, \\
b&=&b_m \\
c&=&c_m \sqrt{1+2 \epsilon_{3,3}\sin^2\beta_m
+\epsilon_{3,3}^2 \sin^2\beta_m}, \\
\cos\beta &=& {\cos\beta_m \over \sqrt{1+2 \epsilon_{3,3}\sin^2\beta_m
+\epsilon_{3,3}^2 \sin^2\beta_m}}.
\end{eqnarray}

Applying $\epsilon_H$ to a $b$-unique (base-centered) monoclinic lattice 
changes $a_m$, $b_m$, $c_m$, and $\cos \beta_m$ to 
\begin{eqnarray}
a&=&a_m \sqrt{1+\epsilon_{1,3}^2}, \\
b&=&b_m, \\
c&=&c_m \sqrt{1+\epsilon_{1,3}^2
+4\epsilon_{1,3} \cos\beta_m \sin\beta_m}, \\
\cos\beta &=& {\cos\beta_m (1+\epsilon_{1,3}^2) + 2 \epsilon_{1,3} 
\sin \beta_m \over \sqrt{1+\epsilon_{1,3}^2}
\sqrt{1+\epsilon_{1,3}^2+4\epsilon_{1,3} \cos\beta_m \sin\beta_m}}.
\end{eqnarray}
The reference system of the strained (base-centered) monoclinic 
lattice is rotated 
with respect to the reference system of the unstrained  
(base-centered) monoclinic lattice. 
The change of coordinates can be written as above with the rotation matrix 
$R^D$ and ${\rm tg}\phi=-\epsilon_{1,3}$.

Applying $\epsilon_G$ to a $b$-unique monoclinic lattice transforms
it into a triclinic lattice with parameters:
\begin{eqnarray}
a&=&a_m \sqrt{1+\epsilon_{1,2}^2}, \\
b&=&b_m \sqrt{1+\epsilon_{1,2}^2}, \\
c&=&c_m \sqrt{1+\epsilon_{1,2}^2 \cos^2\beta_m}, \\
\cos\alpha &=& {2 \epsilon_{1,2} \cos\beta_m \over 
\sqrt{1+\epsilon_{1,2}^2} \sqrt{1+\epsilon_{1,2}^2 \cos^2\beta_m}}, \\
\cos\beta &=& {\cos\beta_m \sqrt{1+\epsilon_{1,2}^2} \over
\sqrt{1+\epsilon_{1,2}^2 \cos^2\beta_m}}, \\
\cos\gamma &=& {2 \epsilon_{1,2}^2 \over 1+\epsilon_{1,2}^2}.
\end{eqnarray}
The reference system of the triclinic lattice is rotated 
with respect to the reference system of the  
monoclinic lattice. 
The change of coordinates can be written as above with the rotation matrix 
$R^E$ and ${\rm tg}\phi=-\epsilon_{1,2}$.

Applying $\epsilon_I$ to a $b$-unique monoclinic lattice transforms
it into a triclinic lattice with parameters:
\begin{eqnarray}
a&=&a_m,  \\
b&=&b_m \sqrt{1+\epsilon_{2,3}^2}, \\
c&=&c_m \sqrt{1+\epsilon_{2,3}^2 \sin^2\beta_m}, \\
\cos\alpha &=& {2 \epsilon_{2,3} \sin\beta_m \over 
\sqrt{1+\epsilon_{2,3}^2} \sqrt{1+\epsilon_{2,3}^2 \sin^2\beta_m}}, \\
\cos\beta &=& { \cos\beta_m  \over
\sqrt{1+\epsilon_{2,3}^2 \sin^2\beta_m}}, \\
\cos\gamma &=& 0. 
\end{eqnarray}
The reference system of the triclinic lattice is rotated 
with respect to the reference system of the  
monoclinic lattice.
The change of coordinates can be written as above with the rotation matrix 
$R^G$ and ${\rm tg}\phi=-\epsilon_{2,3}$.

Applying $\epsilon_G$ to a $b$-unique base-centered monoclinic lattice 
transforms it into a triclinic lattice with parameters:
\begin{eqnarray}
a&=&a_m \sqrt{1+\epsilon_{1,2}^2}, \\
b&=&{1\over 2} \sqrt{(a_m^2+b_m^2)(1+\epsilon_{1,2}^2)+4\epsilon_{1,2}a_mb_m},\\
c&=&c_m \sqrt{1+\epsilon_{1,2}^2 \cos^2\beta_m}, \\
\cos\alpha &=& {\cos\beta_m (a_m (1+\epsilon_{1,2}^2)+2\epsilon_{1,2}b_m) 
\over 
\sqrt{1+\epsilon_{1,2}^2 \cos^2\beta_m} \sqrt{(a_m^2+b_m^2)(1+\epsilon_{1,2}^2)+4\epsilon_{1,2}a_mb_m}}, \\
\cos\beta &=& {\cos\beta_m \sqrt{1+\epsilon_{1,2}^2} \over
\sqrt{1+\epsilon_{1,2}^2 \cos^2\beta_m}}, \\
\cos\gamma &=& {a_m (1+\epsilon_{1,2}^2)+2\epsilon_{1,2}b_m 
\over 
\sqrt{1+\epsilon_{1,2}^2} \sqrt{(a_m^2+b_m^2)(1+\epsilon_{1,2}^2)+4\epsilon_{1,2}a_mb_m}}.
\end{eqnarray}
The reference system of the triclinic lattice is rotated 
with respect to the reference system of the base-centered
monoclinic lattice. 
The change of coordinates can be written as above with the rotation matrix 
$R^E$ and ${\rm tg}\phi=-\epsilon_{1,2}$.

Applying $\epsilon_I$ to a $b$-unique base-centered monoclinic lattice 
transforms it into a triclinic lattice with parameters:
\begin{eqnarray}
a&=&a_m, \\
b&=&{1\over 2} \sqrt{a_m^2+b_m^2(1+\epsilon_{2,3}^2)},\\
c&=&c_m \sqrt{1+\epsilon_{2,3}^2 \sin^2\beta_m}, \\
\cos\alpha &=& {a_m\cos\beta_m +2\epsilon_{2,3}b_m \sin \beta_m 
\over 
\sqrt{1+\epsilon_{2,3}^2 \sin^2\beta_m} 
\sqrt{a_m^2+b_m^2(1+\epsilon_{2,3}^2)}}, \\
\cos\beta &=& {\cos\beta_m \over
\sqrt{1+\epsilon_{2,3}^2 \sin^2\beta_m}}, \\
\cos\gamma &=& {a_m  
\over 
\sqrt{a_m^2+b_m^2(1+\epsilon_{2,3}^2)}}.
\end{eqnarray}
The reference system of the triclinic lattice is rotated 
with respect to the reference system of the base-centered
monoclinic lattice. 
The change of coordinates can be written as above with the rotation matrix 
$R^G$ and ${\rm tg}\phi=-\epsilon_{2,3}$.

{\color{web-blue}\subsection{Triclinic system}}
\color{black}

Any strain applied to a triclinic system will keep the shape of the
unit cell. Only the crystal parameters change, but there is no advantage
to use a rotated triclinic cell with respect to the cell obtained
simply applying the strain directly to the primitive vectors. Therefore
we do not discuss this case any further.

{\color{web-blue}\subsection{Hexagonal system}}
\color{black}

Applying $\epsilon_A$, $\epsilon_B$, or $\epsilon_E$, to an hexagonal cell 
does not change its shape.
Applying $\epsilon_A$, $a_h$ becomes $a_h(1+\epsilon_{1,1})$ and
$c_h$ becomes $c_h(1+\epsilon_{1,1})$ so the ratio $c_h/a_h$ does not
change.
Applying $\epsilon_B$, $a_h$ becomes $a_h(1+\epsilon_{1,1})$ and
$c_h$ does not change, while applying $\epsilon_E$, $c_h$ 
becomes $c_h(1+\epsilon_{3,3})$ and $a_h$ does not change.

Applying $\epsilon_{B'}$ to an hexagonal lattice, it becomes
a base-centered orthorhombic cell with:
\begin{eqnarray}
a&=&a_h (1+\epsilon_{1,1}), \\
b&=&a_h \sqrt{3}, \\
c&=&c_h (1+\epsilon_{1,1}).
\end{eqnarray}

Applying $\epsilon_C$ to an hexagonal lattice, it becomes a base-centered 
orthorhombic lattice with:
\begin{eqnarray}
a&=&a_h (1+\epsilon_{1,1}), \\
b&=&a_h \sqrt{3}, \\
c&=&c_h.
\end{eqnarray}

Applying $\epsilon_H$ to an hexagonal lattice, it becomes a base-centered 
$b$-unique monoclinic cell with
\begin{eqnarray}
a&=&a_h \sqrt{1 + \epsilon_{1,3}^2}, \\
b&=&a_h \sqrt{3}, \\
c&=&c_h \sqrt{1 + \epsilon_{1,3}^2}, \\
\cos\alpha &=& {2 \epsilon_{1,3} \over 1+\epsilon_{1,3}^2}.
\end{eqnarray}
The reference system of the base-centered monoclinic cell is rotated 
with respect to the reference system of the hexagonal cell. 
The change of coordinates can be written as above with the rotation matrix 
$R^D$ and ${\rm tg}\phi=-\epsilon_{1,3}$.

{\color{web-blue}\subsection{Trigonal system}}
\color{black}

Applying $\epsilon_A$ or $\epsilon_E$ to a rhombohedral lattice does
not change its shape. 

Applying $\epsilon_A$ changes $a_r$ to $a_r (1+\epsilon_{1,1})$ while the
rhombohedral angle does not change.

Applying $\epsilon_E$ changes both $a_r$ and the rhombohedral angle
$\alpha_r$. We have 
\begin{eqnarray}
a&=&a_t \sqrt{\sin^2\theta_r + (1 + \epsilon_{1,1})^2 \cos^2\theta_r}, \\
\cos\alpha &=& {
2(1 + \epsilon_{1,1})^2 \cos^2\theta_r -\sin^2\theta_r  \over
2 \left[\sin^2\theta_r+ (1 + \epsilon_{1,1})^2 \cos^2\theta_r\right]}
\end{eqnarray}
where 
$\sin{\theta_r}=\sqrt{2\over 3}\sqrt{1-\cos{\alpha_r}}$
and $\cos{\theta_r}=\sqrt{1\over 3}\sqrt{1 + 2 \cos{\alpha_r}}$. \\

Applying $\epsilon_C$ to a rhombohedral lattice transforms it into a
base-centered $b$-unique monoclinic lattice with parameters:
\begin{eqnarray}
a&=&a_r \sqrt{1 + 3 \cos^2 \theta_r}, \\
b&=&a_r \sqrt{3} (1 + \epsilon_{1,1}) \sin \theta_r, \\
c&=&a_r, \\
\cos\beta &=& {3 \cos^2 \theta_r -1 \over \sqrt{1 + 3 \cos^2 \theta_r} }.
\end{eqnarray}
The reference system of the base-centered monoclinic lattice is rotated 
with respect to the reference system of the rhombohedral lattice.
The change of coordinates can be written as above with the rotation matrix 
\begin{equation}
R^H=\left( \begin{array}{ccc}
0, & -{\sin\theta_r \over \sqrt{1 + 3 \cos^2 \theta_r}}, &  {2\cos\theta_r \over \sqrt{1 + 3 \cos^2 \theta_r}}\\
1, & 0, & 0  
\\
0, & {2\cos\theta_r \over \sqrt{1 + 3 \cos^2 \theta_r}}, & 
{\sin\theta_r \over \sqrt{1 + 3 \cos^2 \theta_r}} 
\end{array}
\right).
\end{equation}

Applying $\epsilon_I$ to a rhombohedral lattice transforms it into a
base-centered $b$-unique monoclinic lattice with parameters:
\begin{eqnarray}
a&=&a_r \sqrt{(1+\epsilon_{2,3}^2)(1 + 3 \cos^2 \theta_r)-
8\epsilon_{2,3}\sin \theta_r\cos \theta_r}, \\
b&=&a_r \sqrt{3}\sin \theta_r, \\
c&=&a_r \sqrt{1+\epsilon_{2,3}^2+4\epsilon_{2,3}\sin \theta_r\cos \theta_r}, \\
\cos\beta &=& {(1+\epsilon_{2,3}^2) (3 \cos^2 \theta_r-1) 
+ 2 \epsilon_{2,3} \sin \theta_r\cos \theta_r
\over \sqrt{(1+\epsilon_{2,3}^2)(1 + 3 \cos^2 \theta_r)-
8\epsilon_{2,3}\sin \theta_r\cos \theta_r} \sqrt{1+\epsilon_{2,3}^2+4\epsilon_{2,3}\sin \theta_r\cos \theta_r}}.
\end{eqnarray}

The reference system of the base-centered monoclinic lattice is rotated 
with respect to the reference system of the rhombohedral lattice.
The change of coordinates can be written as above with the rotation matrix 
\begin{equation}
R^I=\left( \begin{array}{ccc}
0, & a, &  b\\
1, & 0, & 0  
\\
0, & b, & -a 
\end{array}
\right)
\end{equation}
where
\begin{eqnarray}
a&=& {2 \epsilon_{2,3} \cos \theta_r - \sin \theta_r \over 
\sqrt{(1+\epsilon_{2,3}^2)(1 + 3 \cos^2 \theta_r)-
8\epsilon_{2,3}\sin \theta_r\cos \theta_r}}, \\
b&=& {2 \cos \theta_r - \epsilon_{2,3} \sin \theta_r \over 
\sqrt{(1+\epsilon_{2,3}^2)(1 + 3 \cos^2 \theta_r)-
8\epsilon_{2,3}\sin \theta_r\cos \theta_r}}.
\end{eqnarray}

\newpage
{\color{dark-blue}\chapter{The stress tensor}}
\color{black}

Consider a small volume $dV$ of the solid with the form of a prism with 
edges parallel to $x_1$, $x_2$, and $x_3$. Let us call $S_i$ one of
the two surfaces perpendicular to $x_i$ of area $dS_i$. If on this surface 
there is a force ${\bf f}_i=(f_{1,i}, f_{2,i}, f_{3,i})$ where the components
are along $x_1$, $x_2$, and $x_3$, we say that on the solid a
stress: 
\begin{equation}
\sigma_{j,i}=f_{j,i} / dS_i, 
\end{equation}
is acting.
We consider only uniform stresses
that do not depend on the position of the volume $dV$ on the solid.
The force on the other surface perpendicular to $x_i$ is 
$-{\bf f}_i=-(f_{1,i}, f_{2,i}, f_{3,i})$. With this definition a positive
stress pulls outward on the surface of the volume.

The stress is a symmetric tensor so it is possible to use the Voigt
notation. We have
$\sigma_1=\sigma_{1,1}$,
$\sigma_2=\sigma_{2,2}$, $\sigma_3=\sigma_{3,3}$, $\sigma_4=\sigma_{2,3}$,
$\sigma_5=\sigma_{1,3}$, and $\sigma_6=\sigma_{1,2}$.

A uniform pressure applied to the solid is a particular stress that has
only diagonal components. In Voigt notation we have
$\sigma_1=-p$, $\sigma_2=-p$, $\sigma_3=-p$, while the other components
vanish. Conversely we can compute the pressure as:
\begin{equation}
p=-{1\over 3} (\sigma_1 + \sigma_2 + \sigma_3).
\end{equation}
The negative sign indicates that a positive pressure reduces the
volume of the solid so it pushes on the surfaces.

\newpage
{\color{dark-blue}\chapter{Thermodynamic functions}}
\color{black}

The thermodynamic functions can be introduced by using the first law
of thermodynamics and the definition of the entropy ($S$). The heat 
given reversibly to the solid can be written as $dQ=TdS$ where $T$ is
the temperature of the solid and $dS$ its entropy change. The change 
of the internal energy is given by $dU = TdS - dW$ where $dW$ is 
the work done by the solid. If the strain changes by $d\epsilon$ and 
the stress is $\sigma$ then $dW=-V \sum_i \sigma_i d\epsilon_i$, where $V$
is the volume of the unperturbed solid. \\
Therefore
\begin{equation}
dU=TdS + V \sum_{i=1}^6 \sigma_i d\epsilon_i.
\end{equation}
In our approach, this function is not particularly suited for 
calculations because we do not compute the internal energy as a function 
of entropy but as a function of temperature (see Eq.~\ref{uvib}). However
at $T=0$ ($S=0$) we have $\sigma_i={1 \over V} 
{\partial U \over \partial \epsilon_i}$ and, neglecting zero point motion,
we can calculate the derivative of $U_0$. 
Here the derivatives with 
respect to $\epsilon_i$ must be done keeping all the other strain 
components fixed. \\
At $\sigma=0$ the equilibrium strain minimizes $U$. \\ 
At finite stress $\sigma$, 
the equations of state $\sigma_i ={1\over V} 
{\partial U \over \partial \epsilon_i}$
can be obtained by minimizing
\begin{equation}
H= U - V \sum_{i=1}^6 \sigma_i \epsilon_i.
\end{equation}
We have:
\begin{equation}
{1\over V }{\partial H \over \partial \epsilon_i} = {1\over V} 
{\partial U \over \partial \epsilon_i}- 
\sigma_i = 0.
\end{equation}
$H$ is called enthalpy of the solid. \\
For dealing with finite temperatures, it is convenient to introduce the 
Helmholtz free energy by writing $F=U-TS$ so that
\begin{equation}
dF=-S dT + V \sum_{i=1}^6 \sigma_i d\epsilon_i.
\end{equation}
At fixed temperature, the equations of state of the solid are
\begin{equation}
\sigma_i= {1\over V }{\partial F \over \partial \epsilon_i}\Bigg|_T.
\end{equation}
and at zero stress, the strain minimizes $F$.
Here the volume $V$ is the volume at temperature $T$. \\
At finite temperature $T$ and stress $\sigma$, the equations of state
 $\sigma_i={1\over V}
{\partial F\over \partial \epsilon_i}\Big|_T$ can be obtained by 
minimizing the function:
\begin{equation}
G= F - V \sum_{i=1}^6 \sigma_i \epsilon_i.
\end{equation}
We have:
\begin{equation}
{1\over V} {\partial G \over \partial \epsilon_i}\Bigg |_T = {1\over V} 
{\partial F \over \partial \epsilon_i}\Bigg |_T - \sigma_i = 0.
\end{equation}
$G$ is called the Gibbs free energy of the solid.

\newpage
{\color{dark-blue}\chapter{Equilibrium geometry and thermal expansion}}
\color{black}

To calculate the equilibrium geometry at $T=0$ and $\sigma=0$ it
is sufficient to minimize the internal energy with respect to strain:
\begin{equation}
{\partial U \over \partial \epsilon_i}=0.
\end{equation}
Neglecting the contribution of $U_{ph}$ (zero point motion) and
of $U_{el}$ we can minimize 
$U_0$.\\
In practice this equation is difficult to use and one limits to consider
only strains that do not modify the shape of the unit cell. The
vanishing derivatives are imposed only for these strains.
This is equivalent to calculate $U$ as a function of the lattice parameters 
$\zeta_k$ and to check the minimum condition:
\begin{equation}
{\partial U \over \partial \zeta_k}=0.
\end{equation}
Similarly, at the temperature $T$, the equations that define the lattice 
parameters are:
\begin{equation}
{\partial F \over \partial \zeta_k}=0.
\end{equation}
Note that at $T=0$ this equation contains the effect of zero point nuclear
motion. By identifying the position of the minimum at each temperature 
we obtain the parameters $\zeta_k (T)$ that can be compared with
results of X-ray diffraction experiments.

The volume thermal expansion is defined as the variation of the crystal
volume when the temperature changes. Therefore using the parameters
$\zeta_k (T)$ we can calculate the volume $V(T)$
with the expressions written above.  
Numerical differentiation of $V(T)$ gives the volume thermal expansion:
\begin{equation}
\beta = {1 \over V(T)} {d V \over d T}.
\end{equation}

The calculation of the thermal expansion tensor is slightly more
complex. At each temperature the solid has equilibrium parameters
$\zeta_k(T)$. The thermal expansion tensor $\alpha_{i}$ is defined 
as the strain $d\epsilon_{i}(T)$ induced by a change of temperature $dT$. 
We can write
\begin{equation}
\alpha_{i} = {d \epsilon_{i}(T) \over  d T }.
\end{equation}
We have only the crystal parameters $\zeta_k (T)$ and their derivatives
with respect to $T$. These are sufficient to deduce the thermal expansion
$\alpha_{\bf l}(T)$ where ${\bf l}$ is a versor ${\bf l}=(l_1,l_2,l_3)$ 
perpendicular to a set of lattice planes. Considering 
a given set of lattice planes we can write the thermal expansion in
the direction perpendicular to the lattice planes in terms of the tensor 
components $\alpha_{i,j}$
of the thermal expansion as:
\begin{equation}
\alpha_{{\bf l}} = \sum_{ij} \alpha_{i,j} l_i l_j.
\end{equation}
Along the direction ${\bf l}$ we can write:
\begin{equation}
\alpha_{{\bf l}} = {1 \over d_{\bf l}} {d d_{\bf l} \over d T},
\end{equation}
where $d_{\bf l}$ is the interplanar distance for that set of lattice planes.
In the most complex case, for a triclinic solid we need six directions
to set up a linear system whose solutions are the six independent components
of the thermal expansion tensor, while for the other crystal systems 
the thermal expansion can be determined in a simpler manner.
We discuss this point separately for each crystal system.

{\color{web-blue}\subsection{Cubic system}}
\color{black}
In the cubic system $k=1$ and $\zeta_1=a$. 
The thermal expansion tensor is diagonal and the only nonzero components
are all equal: $\alpha_1=\alpha_2=\alpha_3$. We can consider the 
lattice planes perpendicular to ${\bf l}=(0,0,1)$ and the thermal expansion
in the direction ${\bf l}$ is $\alpha_3$. The distance between planes
$d_{\bf l}=a$ in the cubic and $d_{\bf l}=a/2$ in the face-centered
and the body-centered cubic lattices so in all cases:  
\begin{equation}
\alpha_{i} =  {1\over a(T) } {d a(T) \over dT}.
\end{equation}

{\color{web-blue}\subsection{Tetragonal and hexagonal systems}}
\color{black}

In the tetragonal and hexagonal systems $k=2$, $\zeta_1=a$, $\zeta_2=c/a$.
The only nonzero components of the thermal expansion are 
$\alpha_{1}=\alpha_{2}$ and $\alpha_{3}$. We can consider the
lattice planes perpendicular to ${\bf l}=(1,0,0)$ whose distance
is $d_{\bf l}=a$ in the tetragonal lattice and $d_{\bf l}=a/2$ in 
centered tetragonal and hexagonal case. 
For this direction we have $\alpha_{\bf l}=\alpha_1$ and 
\begin{equation}
\alpha_1 = {1\over a(T)} {d a \over dT}.
\end{equation}
Then we can consider the planes perpendicular to ${\bf l}=(0,0,1)$.
The distance between these planes is $d_{\bf l}=c$ for the 
tetragonal and hexagonal lattices and $d_{\bf l}=c/2$ for the 
centered tetragonal lattice. Since $\alpha_{\bf l}=\alpha_3$ we have
\begin{equation}
\alpha_3 = {1\over c(T)} {d c \over dT}. 
\end{equation}
Choosing $a$ and $c/a$ as parameters,
we have to use the equations $c(T)=a(T) (c/a(T))$ and 
\begin{equation}
{dc \over d T} = {da \over d T} c/a(T) + a(T) {d c/a \over dT},
\end{equation}
and we have
\begin{equation}
\alpha_1 = \alpha_2= {1\over a(T)} {d a \over dT}, \ \ \ 
\alpha_3 = {1\over a(T)} {da \over d T}  + {1\over c/a(T)} {d c/a \over dT}.
\end{equation}

{\color{web-blue}\subsection{Trigonal system}}
\color{black}

In the trigonal system $k=2$, $\zeta_1=a$, $\zeta_2=\cos\alpha$. 
The thermal expansion tensor has three diagonal components 
$\alpha_1=\alpha_2$ and $\alpha_3$. We can consider the rhombohedral
lattice as a centered hexagonal lattice with three points per cell
and parameters $a_h$ and $c_h$ related to the rhobohedral parameters
by
\begin{equation}
a_h= a \sqrt{2} \sqrt{1-\cos\alpha}
\end{equation}
and 
\begin{equation}
c_h= a \sqrt{3} \sqrt{1+2\cos\alpha}.
\end{equation}
Considering first the planes perpendicular to the direction
${\bf l}=(1,0,0)$ we have that the distance between planes is
$d_{\bf l}=a_h$ and $\alpha_{\bf l}=\alpha_1$. Therefore
\begin{equation}
\alpha_1 = {1\over a_h(T)} {d a_h \over dT}.
\end{equation}
Then we can consider the planes perpendicular to the direction
${\bf l}=(0,0,1)$ where the distance between planes is
$d_{\bf l}=c_h/3$ and $\alpha_{\bf l}=\alpha_3$. Therefore
\begin{equation}
\alpha_3 = {1\over c_h(T)} {dc_h \over d T}.
\end{equation}
Choosing as parameters $a$ and $\cos \alpha$ we must use the relationships:
\begin{equation}
{d a_h \over d T}= {a_h \over a} {d a \over d T} - {a_h \over 2(1-\cos\alpha)}{d \cos\alpha \over d T},
\end{equation}
\begin{equation}
{d c_h \over d T}= {c_h \over a} {d a \over d T} + {c_h \over 1+2\cos\alpha}{d \cos\alpha \over d T},
\end{equation}
to obtain
\begin{eqnarray}
\alpha_1 &=& \alpha_2= {1\over a(T)} {d a \over dT} - {1 \over 2(1-\cos\alpha)}{d \cos\alpha \over d T}, \\
\alpha_3 &=& {1\over a(T)} {d a \over dT} + {1 \over 1+2\cos\alpha}
{d \cos\alpha \over d T}.
\end{eqnarray}

{\color{web-blue}\subsection{Orthorhombic systems}}
\color{black}

In the orthorhombic system $k=3$, $\zeta_1=a$, $\zeta_2=b/a$, 
$\zeta_3=c/a$. The nonzero components of the thermal expansion are 
$\alpha_{1}$, $\alpha_{2}$, and $\alpha_{3}$. 
Reasoning as in the previous cases and choosing as directions
${\bf l}=(1,0,0)$, ${\bf l}=(0,1,0)$ and ${\bf l}=(0,0,1)$ we find:  
\begin{eqnarray}
\alpha_{1} &=&  {1\over a(T) } {d a \over dT}, \\ 
\alpha_{2} &=&  {1\over b(T) } {d b \over dT}, \\
\alpha_{3} &=&  {1\over c(T) } {d c \over dT}.
\end{eqnarray}
which is valid for the orthorhombic lattice as well as for the
base-centered, the face-centered, and the body-centered orthorhombic lattices.
Choosing $a$, $b/a$, and $c/a$ as parameters we find:
\begin{eqnarray}
\alpha_1 &=& {1\over a(T)} {d a \over dT}, \\
\alpha_2 &=& {1\over a(T)} {da \over d T}  + {1\over b/a(T)} {d b/a \over dT}, \\
\alpha_3 &=& {1\over a(T)} {da \over d T}  + {1\over c/a(T)} {d c/a \over dT}.
\end{eqnarray}

%{\color{web-blue}\subsection{Monoclinic systems}}
%\color{black}
%In the monoclinic system $k=4$, $\zeta_1=a$, $\zeta_2=b$, $\zeta_3=c$, 
%$\zeta_4=\cos\gamma$ (c-unique) of $\zeta_4=\cos\beta$ (b-unique). 
%For the c-unique cell it is simple to define 
%\begin{equation}
%\alpha_{3,3}= {1\over c } {d c \over dT}
%\end{equation}
%For the other two.

%{\color{web-blue}\subsection{Triclinic systems}}
%\color{black}

\newpage
{\color{dark-blue}\chapter{The heat capacity}}
\color{black}

The heat capacity measures the variation of the temperature of the solid
when a certain quantity of heat is given to it at constant strain:
\begin{equation}
C_\epsilon= T {d S \over dT}\Big|_\epsilon = { d U \over d T}\Big|_\epsilon.
\end{equation}
The terms in $U$ that depend on temperature are $U_{el}$ and $U_{ph}$. 
Once the phonon dispersions 
have been calculated $U_{ph}$ can be obtained by deriving Eq.~\ref{uvib}.

For metals the electronic contribution coming from $U_{el}$, while not large, 
is important 
and must be accounted for before comparing with experiment. Presently,
this term is calculated in \tpw\ for a model of independent electrons with
the same density of states (DOS) of the DFT bands. It is calculated together 
with the DOS (see below).

\newpage
{\color{dark-blue}\chapter{The elastic constants}}
\color{black}

When a crystal is deformed with a given strain $\epsilon_i$ forces
appear to bring it back to the equilibrium configuration. These
forces can be described by the stress tensor. For small strain the 
stress tensor is proportional to the strain and we have:
\begin{equation}
\sigma_{i} =\sum_{il} C_{i,l} \epsilon_l 
\end{equation}
$C_{i,l}$ is the tensor of elastic constants. 
At zero temperature and pressure we can write:
\begin{equation}
C_{i,l}= {\partial \sigma_i \over \partial \epsilon_{l}}\Bigg|_{\epsilon=0}=
{1 \over V}{\partial^2 U \over \partial \epsilon_i \partial \epsilon_l}
\Bigg|_{\epsilon=0} = 
{1 \over V}{\partial^2 U \over \partial \eta_i \partial \eta_l}
\Bigg|_{\eta=0}
.
\end{equation}
The nonzero components of the elastic constant tensor for each crystal point
group can be derived using group theory. The form of the elastic constants
tensor depends on the Laue class obtained by adding an inversion center to
the group operations. From this relationship we find that for finite
and small strains the total energy can be written as:
\begin{equation}
U= {V \over 2} \sum_{i,l} \epsilon_i C_{i,l} \epsilon_l.
\end{equation}
By choosing the form of the strain $\epsilon$ and fitting the
energy with a quadratic function we can calculate the elastic constants.
Calculating the stress tensor we can also use the definition
of elastic constants and fit linearly the stress as a function of strain. \\
The procedure depends on the Laue class of the solid. We discuss separately
the different Bravais lattices below.

{\color{web-blue}\subsection{Cubic system}}
\color{black}

The nonzero components of the elastic constants tensor for the cubic system
are independent on the Laue class and are $C_{11}=C_{22}=C_{33}$,
$C_{12}=C_{13}=C_{23}$ and $C_{44}=C_{55}=C_{66}$. [1]
Applying a strain $\epsilon_E$ the cell becomes tetragonal and we have:
\begin{equation}
\sigma_{1} = C_{12} \epsilon_3,
\end{equation}
\begin{equation}
\sigma_{3} = C_{11} \epsilon_3.
\end{equation}
To calculate $C_{44}$ we can apply $\epsilon_F$ that
transforms the cubic cell into a rhombohedral cell as described above. In
this case we obtain
\begin{equation}
\sigma_{4} = C_{44} \epsilon_4,
\end{equation}
and $\sigma_{5} = \sigma_{6} = \sigma_{4}$. \\
In order to calculate the elastic constant using only the energy
we can consider a strain $\epsilon_A$ that gives:
\begin{equation}
U_A = {3 V \over 2} (C_{11} + 2C_{12}) \epsilon_1^2.
\end{equation}
The energy for a strain $\epsilon_E$ gives
\begin{equation}
U_E = {V \over 2} C_{11} \epsilon_3^2,
\end{equation}
and from these two relationships we can obtain both $C_{11}$ and $C_{12}$.
Finally to calculate $C_{44}$, we can apply a strain $\epsilon_F$ 
which gives:
\begin{equation}
U_F = {3 V \over 2} C_{44} \epsilon_4^2.
\end{equation}
By fitting the energy with a polynomial and taking the coefficient of
the quadratic term for these three cases, we can calculate the elastic 
constants as (here and in the following all derivatives are calculated
at $\epsilon=0$):
\begin{eqnarray}
C_{11}&=&{1 \over V} {d^2 U_E \over d \epsilon_3^2}, \\ 
C_{12}&=&{1 \over 6 V} {d^2 U_A \over d \epsilon_1^2}  - {1\over 2} C_{11}, \\
C_{44}&=&{1 \over 3 V} {d^2 U_F \over d \epsilon_4^2}.
\end{eqnarray}
but the use of the energy instead of stress requires three fits instead
of two. 

{\color{web-blue}\subsection{Tetragonal system}}
\color{black}

In this case there are two possibilities depending on the Laue class.
For the point groups $C_{4v} (4mm)$, $D_{2d} (\bar42m)$, $D_4 (422)$ and
$D_{4h} (4/mmm)$ (Laue class $D_{4h} (4/mmm)$) the nonzero components of the 
elastic constants tensor are
$C_{11}=C_{22}$, $C_{12}$, $C_{13}=C_{23}$, $C_{33}$, $C_{44}=C_{55}$, 
$C_{66}$.
For the point groups $C_{4} (4)$, $S_{4} (\bar4)$, $C_{4h} (4/m)$ (Laue class
$C_{4h} (4/m)$) in addition to the components of the elastic constants tensor
discussed above also the $C_{16}=-C_{26}$ components are non zero.

By doing a strain $\epsilon_E$ that conserves the shape of the tetragonal
cell we obtain
\begin{equation}
\sigma_{1} = C_{13} \epsilon_3,
\end{equation}
\begin{equation}
\sigma_{3} = C_{33} \epsilon_3,
\end{equation}
and we obtain $C_{13}$ and $C_{33}$.
To obtain the other components of the tensor we must change the shape of the 
unit cell. $\epsilon_C$ transforms the tetragonal cell in an orthorhombic cell 
and gives:
\begin{equation}
\sigma_{1} = C_{11} \epsilon_1, 
\end{equation}
\begin{equation}
\sigma_{2} = C_{12} \epsilon_1.
\end{equation}
Applying $\epsilon_G$ we obtain:
\begin{equation}
\sigma_{6} = C_{66} \epsilon_6.
\end{equation}
Finally applying the strain $\epsilon_H$ we obtain
\begin{equation}
\sigma_{5} = C_{55} \epsilon_5,
\end{equation}
that gives $C_{55}$. \\
For the Laue class $C_{4h} (4/m)$ the strain $\epsilon_G$ gives also 
\begin{equation}
\sigma_{1} = C_{16} \epsilon_6.
\end{equation}

To use the energy as a function of strain 
we need the following strains and relationships. 
By applying $\epsilon_C$ we get:
\begin{equation}
U_C= {V \over 2} C_{11} \epsilon_1^2.
\end{equation}
By applying $\epsilon_E$ we get:
\begin{equation}
U_E= {V \over 2} C_{33} \epsilon_3^2.
\end{equation}
By applying $\epsilon_B$ we get
\begin{equation}
U_B= {2 V \over 2} (C_{11} + C_{12}) \epsilon_1^2.
\end{equation}
By applying $\epsilon_{B'}$ we get
\begin{equation}
U_{B'}= {V \over 2} (C_{11} + C_{33} + 2 C_{13}) \epsilon_1^2.
\end{equation}
These strains transform the tetragonal into an orthorhombic cell 
and allow us to get four elastic constants. 
To obtain the last two elastic constants we 
must apply $\epsilon_G$ and we get:
\begin{equation}
U_G= {V \over 2} C_{66} \epsilon_6^2,
\end{equation}
applying $\epsilon_H$ we get:
\begin{equation}
U_H= {V \over 2} C_{55} \epsilon_5^2.
\end{equation}
Solving these equations we obtain:
\begin{eqnarray}
C_{11}&=&{1 \over V} {d^2 U_C \over d \epsilon_1^2}, \\ 
C_{33}&=&{1 \over V} {d^2 U_E \over d \epsilon_3^2}, \\ 
C_{12}&=&{1 \over 2 V} {d^2 U_B \over d \epsilon_1^2} - C_{11}, \\
C_{13}&=&{1 \over 2 V} {d^2 U_{B'} \over d \epsilon_1^2} - 
{(C_{11} +C_{33})\over 2}, \\
C_{44}&=&{1 \over V} {d^2 U_G \over d \epsilon_4^2}, \\
C_{66}&=&{1 \over V} {d^2 U_H \over d \epsilon_6^2}.
\end{eqnarray}
For the groups that require $C_{16}$ we must apply simultaneously $\epsilon_C$
and $\epsilon_G$ which give:
\begin{equation}
U_{C+G}={V \over 2} (C_{11}+2C_{16}+C_{66})\epsilon^2,
\end{equation}
from which we obtain:
\begin{equation}
C_{16}={1 \over 2V} {d^2 U_{C+G} \over d \epsilon^2} - {(C_{11}+C_{66})\over 2}.
\end{equation}

{\color{web-blue}\subsection{Orthorhombic system}}
\color{black}

In this system all solids belong to the $D_{2h} (mmm)$ Laue class so
the non zero elements of the elastic constant tensor are the same for all 
point groups and are
$C_{11}$, $C_{12}$, $C_{13}$, $C_{22}$, $C_{23}$,
$C_{33}$, $C_{44}$, $C_{55}$, and $C_{66}$. \\
Applying $\epsilon_C$ we obtain
\begin{eqnarray}
\sigma_1&=&C_{11} \epsilon_1,  \\
\sigma_2&=&C_{12} \epsilon_1,  \\
\sigma_3&=&C_{13} \epsilon_1.
\end{eqnarray}
Applying $\epsilon_D$ we obtain
\begin{eqnarray}
\sigma_2&=&C_{22} \epsilon_2,  \\
\sigma_3&=&C_{23} \epsilon_2.
\end{eqnarray}
Finally applying $\epsilon_E$ we obtain
\begin{equation}
\sigma_3=C_{33} \epsilon_3.
\end{equation}
To obtain the other components of the elastic constant tensor,
we have to modify the shape of the orthorhombic cell. \\
Applying $\epsilon_G$ we have
\begin{equation}
\sigma_6=C_{66} \epsilon_6.
\end{equation}
Applying $\epsilon_H$ we have
\begin{equation}
\sigma_5=C_{55} \epsilon_5.
\end{equation}
Finally applying $\epsilon_I$ we have
\begin{equation}
\sigma_4=C_{44} \epsilon_4.
\end{equation}

To use the energy as a function of strain we need the following strains
and relationships. 
By applying $\epsilon_C$ we get:
\begin{equation}
U_C= {V \over 2} C_{11} \epsilon_1^2.
\end{equation}
By applying $\epsilon_D$ we get:
\begin{equation}
U_D= {V \over 2} C_{22} \epsilon_2^2.
\end{equation}
By applying $\epsilon_E$ we get:
\begin{equation}
U_E= {V \over 2} C_{33} \epsilon_3^2.
\end{equation}
By applying $\epsilon_B$ we get:
\begin{equation}
U_B= {V \over 2} (C_{11} + C_{22} + 2 C_{12}) \epsilon_1^2.
\end{equation}
By applying $\epsilon_{B'}$ we get: 
\begin{equation}
U_{B'}= {V \over 2} (C_{11} + C_{33} + 2 C_{13}) \epsilon_1^2.
\end{equation}
By applying $\epsilon_{B''}$ we get:
\begin{equation}
U_{B''}= {V \over 2} (C_{22} + C_{33} + 2 C_{23}) \epsilon_2^2.
\end{equation}
These strains conserve the orthorhombic cell and allow us to get
six elastic constants. To obtain the last three elastic constants we 
apply $\epsilon_G$ to obtain
\begin{equation}
U_G= {V \over 2} C_{66} \epsilon_6^2,
\end{equation}
$\epsilon_H$ to obtain
\begin{equation}
U_H= {V \over 2} C_{55} \epsilon_5^2,
\end{equation}
and $\epsilon_I$ to obtain
\begin{equation}
U_I= {V \over 2} C_{44} \epsilon_4^2.
\end{equation}
Solving these equations we have:
\begin{eqnarray}
C_{11}&=&{1 \over V} {d^2 U_C \over d \epsilon_1^2}, \\ 
C_{22}&=&{1 \over V} {d^2 U_D \over d \epsilon_2^2}, \\ 
C_{33}&=&{1 \over V} {d^2 U_E \over d \epsilon_3^2}, \\ 
C_{12}&=&{1 \over 2 V} {d^2 U_B \over d \epsilon_1^2} - 
{(C_{11}+C_{22})\over 2}, \\
C_{13}&=&{1 \over 2 V} {d^2 U_{B'} \over d \epsilon_1^2} - 
{(C_{11}+C_{33})\over 2}, \\
C_{23}&=&{1 \over 2 V} {d^2 U_{B''} \over d \epsilon_2^2} - 
{(C_{22}+C_{33})\over 2}, \\
C_{44}&=&{1 \over V} {d^2 U_I \over d \epsilon_4^2}, \\
C_{55}&=&{1 \over V} {d^2 U_H \over d \epsilon_5^2}, \\
C_{66}&=&{1 \over V} {d^2 U_G \over d \epsilon_6^2}.
\end{eqnarray}

{\color{web-blue}\subsection{Monoclinic system}}
\color{black}

The non zero components of the elastic constants tensor depend on the choice
of the unit cell $b$-unique or $c$-unique. 
$C_{11}$, $C_{12}$, $C_{13}$, $C_{22}$, $C_{23}$, $C_{33}$, $C_{44}$, 
$C_{55}$, and $C_{66}$ are always different from zero, while for the
$b$-unique cell also the $C_{15}$, $C_{25}$, $C_{35}$, and $C_{46}$ components
are different from zero. For the $c$-unique cell, instead, $C_{16}$, $C_{26}$, 
$C_{36}$, and $C_{45}$ are different from zero. \\
Applying $\epsilon_C$ we obtain:
\begin{eqnarray}
\sigma_1&=&C_{11} \epsilon_1,  \\
\sigma_2&=&C_{12} \epsilon_1,  \\
\sigma_3&=&C_{13} \epsilon_1.  
\end{eqnarray}
Applying $\epsilon_D$ we obtain:
\begin{eqnarray}
\sigma_2&=&C_{22} \epsilon_2,  \\
\sigma_3&=&C_{23} \epsilon_2.  
\end{eqnarray}
Finally applying $\epsilon_E$ we obtain:
\begin{eqnarray}
\sigma_3&=&C_{33} \epsilon_3.
\end{eqnarray}
Applying $\epsilon_I$ we obtain:
\begin{eqnarray}
\sigma_4&=&C_{44} \epsilon_4,
\end{eqnarray}
applying $\epsilon_H$ we obtain:
\begin{eqnarray}
\sigma_5&=&C_{55} \epsilon_5,
\end{eqnarray}
and applying $\epsilon_G$ we obtain:
\begin{eqnarray}
\sigma_6&=&C_{66} \epsilon_6. 
\end{eqnarray}
Moreover, for the $b$-unique cell: 
\begin{eqnarray}
\sigma_5&=&C_{15} \epsilon_1,
\end{eqnarray}
\begin{eqnarray}
\sigma_5&=&C_{25} \epsilon_2,
\end{eqnarray}
\begin{eqnarray}
\sigma_5&=&C_{35} \epsilon_3,
\end{eqnarray}
\begin{eqnarray}
\sigma_6&=&C_{46} \epsilon_4,
\end{eqnarray}
while for the $c$-unique cell we have:
\begin{eqnarray}
\sigma_6&=&C_{16} \epsilon_1,
\end{eqnarray}
\begin{eqnarray}
\sigma_6&=&C_{26} \epsilon_2,
\end{eqnarray}
\begin{eqnarray}
\sigma_6&=&C_{36} \epsilon_3,
\end{eqnarray}
\begin{eqnarray}
\sigma_5&=&C_{45} \epsilon_4.
\end{eqnarray}

Having only the energy we can use the following
relationships. By applying $\epsilon_C$ we get:
\begin{equation}
U_C= {V \over 2} C_{11} \epsilon_1^2.
\end{equation}
By applying $\epsilon_D$ we get:
\begin{equation}
U_D= {V \over 2} C_{22} \epsilon_2^2.
\end{equation}
By applying $\epsilon_E$ we get:
\begin{equation}
U_E= {V \over 2} C_{33} \epsilon_3^2.
\end{equation}
By applying $\epsilon_B$ we get:
\begin{equation}
U_B= {V \over 2} (C_{11} + C_{22} + 2 C_{12}) \epsilon_1^2.
\end{equation}
By applying $\epsilon_{B'}$ in which only $\epsilon_1$ and
$\epsilon_3=\epsilon_1$ are non zero, we get:
\begin{equation}
U_{B'}= {V \over 2} (C_{11} + C_{33} + 2 C_{13}) \epsilon_1^2.
\end{equation}
By applying $\epsilon_{B''}$ in which only $\epsilon_2$ and
$\epsilon_3=\epsilon_2$ are non zero, we get:
\begin{equation}
U_{B''}= {V \over 2} (C_{22} + C_{33} + 2 C_{23}) \epsilon_2^2,
\end{equation}
and in this way we get six elastic constants. Continuing as in the
orthorhombic case we can
apply $\epsilon_G$ and we get:
\begin{equation}
U_G= {V \over 2} C_{66} \epsilon_6^2.
\end{equation}
By applying $\epsilon_H$ we obtain:
\begin{equation}
U_H= {V \over 2} C_{55} \epsilon_5^2.
\end{equation}
By applying $\epsilon_I$ we obtain:
\begin{equation}
U_I= {V \over 2} C_{44} \epsilon_4^2.
\end{equation}
In the monoclinic system the elastic constants have other four non zero 
components.
Applying simultaneously two strains we can get combinations of these 
elastic constants with those already calculated. \\
For instance, in the $c$-unique case, applying $\epsilon_C$ and 
$\epsilon_G$ we obtain:
\begin{equation}
U_{C+G}= {V \over 2} (C_{11}+2 C_{16} + C_{66}) \epsilon^2,
\end{equation}
applying $\epsilon_D$ and $\epsilon_G$ we obtain:
\begin{equation}
U_{D+G}= {V \over 2} (C_{22}+2 C_{26} + C_{66}) \epsilon^2,
\end{equation}
and applying $\epsilon_E$ and $\epsilon_G$ we obtain:
\begin{equation}
U_{E+G}= {V \over 2} (C_{33}+2 C_{36} + C_{66}) \epsilon^2.
\end{equation}
In order to calculate the last component we need to apply
simultaneously two shear strains. 
Applying $\epsilon_H$ and $\epsilon_I$ we obtain:
\begin{equation}
U_{H+I}= {V \over 2} (C_{44}+2 C_{45} + C_{55}) \epsilon^2.
\end{equation}
Similarly, in the $b$-unique case, applying $\epsilon_C$ and 
$\epsilon_H$ we obtain:
\begin{equation}
U_{C+H}= {V \over 2} (C_{11}+2 C_{15} + C_{55}) \epsilon^2,
\end{equation}
applying $\epsilon_D$ and $\epsilon_H$ we obtain:
\begin{equation}
U_{D+H}= {V \over 2} (C_{22}+2 C_{25} + C_{55}) \epsilon^2,
\end{equation}
and applying $\epsilon_E$ and $\epsilon_H$ we obtain:
\begin{equation}
U_{E+H}= {V \over 2} (C_{33}+2 C_{35} + C_{55}) \epsilon^2.
\end{equation}
Finally, applying $\epsilon_G$ and $\epsilon_I$ we obtain:
\begin{equation}
U_{G+I}= {V \over 2} (C_{44}+2 C_{46} + C_{66}) \epsilon^2.
\end{equation}
Solving these equations we obtain:
\begin{eqnarray}
C_{11}&=&{1 \over V} {d^2 U_C \over d \epsilon_1^2}, \\ 
C_{22}&=&{1 \over V} {d^2 U_D \over d \epsilon_2^2}, \\ 
C_{33}&=&{1 \over V} {d^2 U_E \over d \epsilon_3^2}, \\ 
C_{12}&=&{1 \over 2 V} {d^2 U_B \over d \epsilon_1^2} - 
                             {(C_{11}+ C_{22})\over 2}, \\
C_{13}&=&{1 \over 2 V} {d^2 U_{B'} \over d \epsilon_1^2} - 
                             {(C_{11} + C_{33})\over 2}, \\
C_{23}&=&{1 \over 2 V} {d^2 U_{B''} \over d \epsilon_2^2} - 
                             {(C_{22} - C_{33})\over 2}, \\
C_{44}&=&{1 \over V} {d^2 U_I \over d \epsilon_4^2}, \\
C_{55}&=&{1 \over V} {d^2 U_H \over d \epsilon_5^2}, \\
C_{66}&=&{1 \over V} {d^2 U_G \over d \epsilon_6^2}.
\end{eqnarray}
In the $c$-unique case we have:
\begin{eqnarray}
C_{16}&=&{1 \over 2 V} {d^2 U_{C+G} \over d \epsilon^2} - {(C_{11} + C_{66})\over 2}, \\
C_{26}&=&{1 \over 2 V} {d^2 U_{D+G} \over d \epsilon^2} - {(C_{22} + C_{66})\over 2}, \\
C_{36}&=&{1 \over 2 V} {d^2 U_{E+G} \over d \epsilon^2} - {(C_{33} + C_{66})\over 2}, \\
C_{45}&=&{1 \over 2 V} {d^2 U_{H+I} \over d \epsilon^2} - {(C_{44} + C_{55})\over 2},
\end{eqnarray}
while in the $b$-unique case:
\begin{eqnarray}
C_{15}&=&{1 \over 2 V} {d^2 U_{C+H} \over d \epsilon^2} - {(C_{11} + C_{55})\over 2}, \\
C_{25}&=&{1 \over 2 V} {d^2 U_{D+H} \over d \epsilon^2} - {(C_{22} + C_{55})\over 2}, \\
C_{35}&=&{1 \over 2 V} {d^2 U_{E+H} \over d \epsilon^2} - {(C_{33} + C_{55})\over 2}, \\
C_{46}&=&{1 \over 2 V} {d^2 U_{G+I} \over d \epsilon^2} - {(C_{44} + C_{66})\over 2}. 
\end{eqnarray}

{\color{web-blue}\subsection{Triclinic system}}
\color{black}

In this case all the components of the elastic constant tensors are non zero.
We can apply $\epsilon_C$ and obtain:
\begin{eqnarray}
\sigma_1&=&C_{11} \epsilon_1,  \\
\sigma_2&=&C_{12} \epsilon_1,  \\
\sigma_3&=&C_{13} \epsilon_1,  \\
\sigma_4&=&C_{14} \epsilon_1,  \\
\sigma_5&=&C_{15} \epsilon_1,  \\
\sigma_6&=&C_{16} \epsilon_1,  \\
\end{eqnarray}
where we have used the symmetry of the elastic constants matrix.
Applying $\epsilon_D$ we obtain:
\begin{eqnarray}
\sigma_2&=&C_{22} \epsilon_2,  \\
\sigma_3&=&C_{23} \epsilon_2,  \\
\sigma_4&=&C_{24} \epsilon_2,  \\
\sigma_5&=&C_{25} \epsilon_2,  \\
\sigma_6&=&C_{26} \epsilon_2.  \\
\end{eqnarray}
Applying $\epsilon_E$ we obtain:
\begin{eqnarray}
\sigma_3&=&C_{33} \epsilon_3,  \\
\sigma_4&=&C_{34} \epsilon_3,  \\
\sigma_5&=&C_{35} \epsilon_3,  \\
\sigma_6&=&C_{36} \epsilon_3.  \\
\end{eqnarray}
Applying $\epsilon_I$ we obtain:
\begin{eqnarray}
\sigma_4&=&C_{44} \epsilon_4,  \\
\sigma_5&=&C_{45} \epsilon_4,  \\
\sigma_6&=&C_{46} \epsilon_4.  \\
\end{eqnarray}
Applying $\epsilon_H$ we obtain:
\begin{eqnarray}
\sigma_5&=&C_{55} \epsilon_5,  \\
\sigma_6&=&C_{56} \epsilon_5.  \\
\end{eqnarray}
Applying $\epsilon_G$ we obtain:
\begin{eqnarray}
\sigma_6&=&C_{66} \epsilon_6.  \\
\end{eqnarray}
Clearly in all cases, independent of the lattice, these equations can be
applied to calculate the elastic constants, neglecting any symmetry
information, but the number of calculations is larger than that needed
when symmetry is used.

To use the energy in the calculation we use the following
relationships. By applying $\epsilon_C$ we get:
\begin{equation}
U_C= {V \over 2} C_{11} \epsilon_1^2.
\end{equation}
By applying $\epsilon_D$ we get:
\begin{equation}
U_D= {V \over 2} C_{22} \epsilon_2^2.
\end{equation}
By applying $\epsilon_E$ we get:
\begin{equation}
U_E= {V \over 2} C_{33} \epsilon_3^2.
\end{equation}
By applying $\epsilon_B$ we get:
\begin{equation}
U_B= {V \over 2} (C_{11} + C_{22} + 2 C_{12}) \epsilon_1^2.
\end{equation}
By applying $\epsilon_{B'}$ in which only $\epsilon_1$ and
$\epsilon_3=\epsilon_1$ are non zero, we get:
\begin{equation}
U_{B'}= {V \over 2} (C_{11} + C_{33} + 2 C_{13}) \epsilon_1^2.
\end{equation}
By applying $\epsilon_{B''}$ in which only $\epsilon_2$ and
$\epsilon_3=\epsilon_2$ are non zero, we get:
\begin{equation}
U_{B''}= {V \over 2} (C_{22} + C_{33} + 2 C_{23}) \epsilon_2^2,
\end{equation}
and in this way we get six elastic constant. Continuing as in the
orthorhombic case we can
apply $\epsilon_G$ and we get:
\begin{equation}
U_G= {V \over 2} C_{66} \epsilon_6^2.
\end{equation}
By applying $\epsilon_H$ we obtain:
\begin{equation}
U_H= {V \over 2} C_{55} \epsilon_5^2.
\end{equation}
By applying $\epsilon_I$ we obtain:
\begin{equation}
U_I= {V \over 2} C_{44} \epsilon_4^2.
\end{equation}
The triclinic case has twelve components. Applying simultaneously two strains
we can get combinations of other elastic constants with those already
calculated. For instance applying $\epsilon_C + \epsilon_G$ and taking
$\epsilon_1=\epsilon_6=\epsilon$ we obtain:
\begin{equation}
U_{C+G}= {V \over 2} (C_{11}+2 C_{16} + C_{66}) \epsilon^2.
\end{equation}
Similarly applying $\epsilon_C + \epsilon_H$ and taking $\epsilon_1=
\epsilon_5=\epsilon$ we obtain:
\begin{equation}
U_{C+H}= {V \over 2} (C_{11}+2 C_{15} + C_{55}) \epsilon^2.
\end{equation}
Similarly applying $\epsilon_C + \epsilon_I$ and taking
$\epsilon_1=\epsilon_4=\epsilon$ we obtain:
\begin{equation}
U_{C+I}= {V \over 2} (C_{11}+2 C_{14} + C_{44}) \epsilon^2.
\end{equation}
Then we can apply $\epsilon_D + \epsilon_G$ taking
$\epsilon_2=\epsilon_6=\epsilon$ and we obtain:
\begin{equation}
U_{D+G}= {V \over 2} (C_{22}+2 C_{26} + C_{66}) \epsilon^2.
\end{equation}
Similarly applying $\epsilon_D + \epsilon_H$ taking
$\epsilon_2=\epsilon_5=\epsilon$ and we obtain:
\begin{equation}
U_{D+H}= {V \over 2} (C_{22}+2 C_{25} + C_{55}) \epsilon^2.
\end{equation}
Similarly applying $\epsilon_D + \epsilon_I$ taking
$\epsilon_2=\epsilon_4=\epsilon$ and we obtain:
\begin{equation}
U_{D+I}= {V \over 2} (C_{22}+2 C_{24} + C_{44}) \epsilon^2.
\end{equation}
Then we can apply $\epsilon_E + \epsilon_G$ taking
$\epsilon_3=\epsilon_6=\epsilon$ and we obtain:
\begin{equation}
U_{E+G}= {V \over 2} (C_{33}+2 C_{36} + C_{66}) \epsilon^2.
\end{equation}
Similarly applying $\epsilon_E + \epsilon_H$ taking
$\epsilon_3=\epsilon_5=\epsilon$ and we obtain:
\begin{equation}
U_{E+H}= {V \over 2} (C_{33}+2 C_{35} + C_{55}) \epsilon^2,
\end{equation}
and applying $\epsilon_E + \epsilon_I$ taking
$\epsilon_3=\epsilon_4=\epsilon$ and we obtain:
\begin{equation}
U_{E+I}= {V \over 2} (C_{33}+2 C_{34} + C_{44}) \epsilon^2.
\end{equation}
In order to calculate the last three components we need to apply
simultaneously two shear strains. Applying $\epsilon_G + \epsilon_H$ 
and taking $\epsilon_6=\epsilon_5=\epsilon$ we obtain:
\begin{equation}
U_{G+H}= {V \over 2} (C_{55}+2 C_{56} + C_{66}) \epsilon^2.
\end{equation}
Similarly applying $\epsilon_G + \epsilon_I$
and taking $\epsilon_6=\epsilon_4=\epsilon$
\begin{equation}
U_{G+I}= {V \over 2} (C_{44}+2 C_{46} + C_{66}) \epsilon^2.
\end{equation}
Finally applying $\epsilon_H + \epsilon_I$
and taking $\epsilon_5=\epsilon_4=\epsilon$
\begin{equation}
U_{H+I}= {V \over 2} (C_{44}+2 C_{45} + C_{55}) \epsilon^2.
\end{equation}
Solving these equations we obtain:
\begin{eqnarray}
C_{11}&=&{1 \over V} {d^2 U_C \over d \epsilon_1^2}, \\ 
C_{22}&=&{1 \over V} {d^2 U_D \over d \epsilon_2^2}, \\ 
C_{33}&=&{1 \over V} {d^2 U_E \over d \epsilon_3^2}, \\ 
C_{12}&=&{1 \over 2 V} {d^2 U_B \over d \epsilon_1^2} - 
                             {(C_{11}+ C_{22})\over 2}, \\
C_{13}&=&{1 \over 2 V} {d^2 U_{B'} \over d \epsilon_1^2} - 
                             {(C_{11} + C_{33})\over 2}, \\
C_{23}&=&{1 \over 2 V} {d^2 U_{B''} \over d \epsilon_2^2} - 
                             {(C_{22} - C_{33})\over 2}, \\
C_{44}&=&{1 \over V} {d^2 U_I \over d \epsilon_4^2}, \\
C_{55}&=&{1 \over V} {d^2 U_H \over d \epsilon_5^2}, \\
C_{66}&=&{1 \over V} {d^2 U_G \over d \epsilon_6^2}, \\
C_{14}&=&{1 \over 2 V} {d^2 U_{C+I} \over d \epsilon^2} - {(C_{11} + C_{44})\over 2}, \\
C_{15}&=&{1 \over 2 V} {d^2 U_{C+H} \over d \epsilon^2} - {(C_{11} + C_{55})\over 2}, \\
C_{16}&=&{1 \over 2 V} {d^2 U_{C+G} \over d \epsilon^2} - {(C_{11} + C_{66})\over 2}, \\
C_{24}&=&{1 \over 2 V} {d^2 U_{D+I} \over d \epsilon^2} - {(C_{22} + C_{44})\over 2}, \\
C_{25}&=&{1 \over 2 V} {d^2 U_{D+H} \over d \epsilon^2} - {(C_{22} + C_{55})\over 2}, \\
C_{26}&=&{1 \over 2 V} {d^2 U_{D+G} \over d \epsilon^2} - {(C_{22} + C_{66})\over 2}, \\
C_{34}&=&{1 \over 2 V} {d^2 U_{E+I} \over d \epsilon^2} - {(C_{33} + C_{44})\over 2}, \\
C_{35}&=&{1 \over 2 V} {d^2 U_{E+H} \over d \epsilon^2} - {(C_{33} + C_{55})\over 2}, \\
C_{36}&=&{1 \over 2 V} {d^2 U_{E+G} \over d \epsilon^2} - {(C_{33} + C_{66})\over 2}, \\
C_{45}&=&{1 \over 2 V} {d^2 U_{H+I} \over d \epsilon^2} - {(C_{44} + C_{55})\over 2}, \\
C_{46}&=&{1 \over 2 V} {d^2 U_{G+I} \over d \epsilon^2} - {(C_{44} + C_{66})\over 2}, \\
C_{56}&=&{1 \over 2 V} {d^2 U_{G+H} \over d \epsilon^2} - {(C_{55} + C_{66})\over 2}.
\end{eqnarray}

{\color{web-blue}\subsection{Hexagonal system}}
\color{black}

In this case the form of the elastic constants tensor is independent of
the Laue class. The nonzero components are $C_{11}=C_{22}$, $C_{12}$, 
$C_{13}=C_{23}$, $C_{33}$, $C_{44}=C_{55}$, $C_{66}={1\over 2} 
(C_{11}-C_{12})$. 
$C_{11}$, $C_{12}$ and $C_{13}$ can be obtained by doing a strain $\epsilon_C$,
transforming the hexagonal cell into a base-centered orthorhombic
cell. We have:
\begin{eqnarray}
\sigma_1&=&C_{11} \epsilon_1,  \\
\sigma_2&=&C_{12} \epsilon_1,  \\
\sigma_3&=&C_{13} \epsilon_1.
\end{eqnarray}
The strain $\epsilon_E$ conserves the shape of the hexagonal cell and
gives $C_{33}$:
\begin{eqnarray}
\sigma_3&=&C_{33} \epsilon_3.  
\end{eqnarray}
In order to obtain $C_{44}=C_{55}$ we can apply a strain $\epsilon_H$ 
that transforms the hexagonal cell into a base-centered monoclinic cell.
We have
\begin{eqnarray}
\sigma_5&=&C_{55} \epsilon_5. 
\end{eqnarray}

To use the energy as a function of strain 
we need the following strains and relationships. \\
By applying $\epsilon_C$, we get $C_{11}$:
\begin{equation}
U_C= {V \over 2} C_{11} \epsilon_1^2.
\end{equation}
By applying $\epsilon_E$, we get $C_{33}$:
\begin{equation}
U_E= {V \over 2} C_{33} \epsilon_3^2.
\end{equation}
By applying $\epsilon_{B'}$ in which only $\epsilon_1$ and 
$\epsilon_3=\epsilon_1$ are non zero, we have:
\begin{equation}
U_{B'}= {V \over 2} (C_{11} + C_{33} + 2 C_{13}) \epsilon_1^2,
\end{equation}
and using the previously calculated elastic constants, we can obtain $C_{13}$.
By applying $\epsilon_A$, we get
\begin{equation}
U_A= {V \over 2} (2C_{11} + C_{33} + 2 C_{12} + 4 C_{13}) \epsilon_1^2,
\end{equation}
and using the previously calculated elastic constants, we can obtain $C_{12}$.
Finally applying $\epsilon_H$, we obtain $C_{55}$:
\begin{equation}
U_H= {V \over 2} C_{55} \epsilon_5^2.
\end{equation}
Solving these equations we obtain:
\begin{eqnarray}
C_{11}&=&{1 \over V} {d^2 U_C \over d \epsilon_1^2}, \\ 
C_{33}&=&{1 \over V} {d^2 U_E \over d \epsilon_3^2}, \\ 
C_{13}&=&{1 \over 2 V} {d^2 U_{B'} \over d \epsilon_1^2} - 
{(C_{11} + C_{33})\over 2}, \\
C_{12}&=&{1 \over 2 V} {d^2 U_A \over d \epsilon_1^2} - C_{11} - 
{C_{33} \over 2} - 2 C_{13}, \\
C_{55}&=&{1 \over V} {d^2 U_I \over d \epsilon_5^2}. \\
\end{eqnarray}

{\color{web-blue}\subsection{Trigonal system}}
\color{black}

In this case there are two possibilities depending on the Laue class. For
the point groups $D_3(32)$, $C_{3v}(3m)$ and $D_{3d}(\bar 3m)$ (Laue class
$D_{3d}(\bar 3m)$) the nonzero components of the elastic constant tensor
are $C_{11}=C_{22}$, $C_{12}$, $C_{13}=C_{23}$, $C_{33}$, $C_{44}=C_{55}$, 
$C_{66}={1\over 2} (C_{11}-C_{12})$, $C_{14}$, $C_{24}=-C_{14}$, and 
$C_{56}=C_{14}$. For the point groups $C_3(3)$ and $S_6(\bar 3)$ (Laue
class $S_6(\bar 3)$) there are other three nonzero components $C_{15}$, 
$C_{25}=-C_{15}$ and $C_{46}=-C_{15}$. 
By doing a strain $\epsilon_C$ we obtain:
\begin{equation}
\sigma_1=C_{11} \epsilon_1,
\end{equation}
\begin{equation}
\sigma_2=C_{12} \epsilon_1,
\end{equation}
\begin{equation}
\sigma_3=C_{13} \epsilon_1,
\end{equation}
\begin{equation}
\sigma_4=C_{14} \epsilon_1.
\end{equation}
Applying $\epsilon_E$ we have:
\begin{equation}
\sigma_3=C_{33} \epsilon_3,
\end{equation}
Finally, applying $\epsilon_G$ we have:
\begin{equation}
\sigma_4=C_{44} \epsilon_4,
\end{equation}
For the Laue class $S_6(\bar 3)$ we have also:
\begin{equation}
\sigma_5=C_{15} \epsilon_1.
\end{equation}

To use the energy as a function of strain 
we need the following strains and relationships. \\
By applying $\epsilon_C$ we get $C_{11}$:
\begin{equation}
U_C = {V \over 2} C_{11} \epsilon_1^2. 
\end{equation}
By applying $\epsilon_E$ we get $C_{33}$:
\begin{equation}
U_E = {V \over 2} C_{33} \epsilon_3^2. 
\end{equation}
By applying $\epsilon_B'$ in which only $\epsilon_1$ and 
$\epsilon_3=\epsilon_1$ we have:
\begin{equation}
U_{B'} = {V \over 2} (C_{11}+C_{33}+2C_{13}) \epsilon_1^2, 
\end{equation}
and using the previously calculated elastic constants, we can obtain
$C_{13}$. By applying $\epsilon_A$ we get:
\begin{equation}
U_{A} = {V \over 2} (2C_{11}+C_{33}+2C_{12}+4C_{13}) \epsilon_1^2,
\end{equation}
and using the previously calculated elastic constants we obtain $C_{12}$.
Applying $\epsilon_H$ we obtain $C_{44}$:
\begin{equation}
U_{H} = {V \over 2} C_{44} \epsilon_5^2.
\end{equation}
Finally applying $\epsilon_C$ and $\epsilon_I$ we obtain:
\begin{equation}
U_{C+I} = {V \over 2} (C_{11} + C_{44}+ 2 C_{14}) \epsilon_1^2 
\end{equation}
and using the previously calculated elastic constants we obtain $C_{14}$. \\
Solving these equations we obtain:
\begin{eqnarray}
C_{11} &=& {1 \over V} {d^2 U_C \over d \epsilon_1^2}, \\
C_{33} &=& {1 \over V} {d^2 U_E \over d \epsilon_3^2}, \\
C_{13} &=& {1 \over 2 V} {d^2 U_{B'} \over d \epsilon_1^2} - 
{(C_{11} + C_{33})\over 2}, \\
C_{12} &=& {1 \over 2 V} {d^2 U_{A} \over d \epsilon_1^2} - 
C_{11} - {C_{33}\over 2} - 2 C_{13}, \\
C_{44} &=& {1 \over V} {d^2 U_H \over d \epsilon_5^2}, \\
C_{14} &=& {1 \over 2 V} {d^2 U_{C+I} \over d \epsilon_1^2} - 
{(C_{11} + C_{44})\over 2}. 
\end{eqnarray}

For the Laue class $S_6(\bar 3)$ we can apply 
$\epsilon_C$ and $\epsilon_G$ and we get:
\begin{equation}
U_{C+G} = {V \over 2} (C_{11} + C_{44}+ 2 C_{25}) \epsilon_1^2. 
\end{equation}
Solving this equation we obtain:
\begin{equation}
C_{25} = {1 \over 2 V} {d^2 U_{C+G} \over d \epsilon_1^2} - 
{(C_{11} + C_{44})\over 2}.
\end{equation}

\newpage
{\color{dark-blue}\chapter{Stress or pressure dependent elastic constants}}
\color{black}

The elastic constants of a solid on which we apply a stress 
$\sigma^{(0)}_{ij}$ can still
be defined from the linear relationship between applied strain and 
induced stress: 
\begin{equation}
\sigma_{ij} =\sigma^{(0)}_{ij}+\sum_{kl} B_{ij,kl} \epsilon_{kl}.
\end{equation}
However since the solid is already in a strained state
to balance the stress $\sigma^{(0)}_{ij}$, the second derivatives of
the energy with respect to the strain:
\begin{equation}
{1 \over V}{\partial^2 U \over \partial \epsilon_{ij} \partial \epsilon_{kl}}
\Bigg|_{\epsilon=0},
\end{equation}
do not coincide neither with the elastic constants
$C_{ij,kl}={1 \over V}{\partial^2 U \over \partial \eta_{ij} \partial 
\eta_{kl}}\big|_{\eta=0}$ nor with $B_{ij,kl}$. Actually there is a simple 
relationship between $B_{ij,kl}$ and the 
second derivatives of the energy with respect to the strains
$\epsilon_{ij}$ and $\epsilon_{kl}$ [3]:
\begin{equation}
B_{ij,kl} = {1 \over V}{\partial^2 U \over \partial \epsilon_{ij} 
\partial \epsilon_{kl}}\Bigg|_{\epsilon=0} - 
{1\over 2} (2 \sigma^{(0)}_{ij} \delta_{kl} 
-{1\over 2} \sigma^{(0)}_{ik} \delta_{jl} 
-{1\over 2} \sigma^{(0)}_{il} \delta_{jk} 
-{1\over 2} \sigma^{(0)}_{jk} \delta_{il} 
-{1\over 2} \sigma^{(0)}_{jl} \delta_{ik} ).
\label{eqsd2}
\end{equation}
To find the elastic constants of a solid under pressure we can
put in this formula $\sigma^{(0)}_{ij}=-p \delta_{ij}$ and we
have:
\begin{equation}
B_{ij,kl} = {1 \over V}{\partial^2 U \over \partial \epsilon_{ij} 
\partial \epsilon_{kl}}\Bigg|_{\epsilon=0} + 
{1\over 2} p (2 \delta_{ij} \delta_{kl} - 
 \delta_{il} \delta_{jk} - \delta_{ik} \delta_{jl} ).
\end{equation}
Since experiments usually measure the stress-strain elastic constants,
it is common to give the numerical values of $B_{ij,kl}$ and to call them 
the elastic constants of a solid under pressure. 

We can write out the relationship for each component: 
\begin{eqnarray}
B_{12,12} &=& {1 \over V}{\partial^2 U \over \partial \epsilon^2_{12}}\Bigg|_{\epsilon=0} - {1\over 2} p, \\
B_{13,13} &=& {1 \over V}{\partial^2 U \over \partial \epsilon^2_{13} 
}\Bigg|_{\epsilon=0} - {1\over 2} p, \\
B_{23,23} &=& {1 \over V}{\partial^2 U \over \partial \epsilon^2_{23} 
}\Bigg|_{\epsilon=0} - {1\over 2} p, \\
B_{11,22} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{11} 
\partial \epsilon_{22}}\Bigg|_{\epsilon=0} + p, \\
B_{11,33} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{11} 
\partial \epsilon_{33}}\Bigg|_{\epsilon=0} + p, \\
B_{22,33} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{22} 
\partial \epsilon_{33}}\Bigg|_{\epsilon=0} + p, 
\end{eqnarray}
while for all the other components $B_{ij,kj}=
{1 \over V}{\partial^2 U \over \partial \epsilon_{ij} 
\partial \epsilon_{kl}}\big|_{\epsilon=0}$.

For a generic stress, as opposed to an isotropic pressure, the $B_{ij,kl}$ 
have not the same symmetry properties of $C_{ij,kl}$. In general, for a 
symmetric $\sigma^{(0)}_{ij}$ we have $B_{ij,kl}=B_{ji,kl}=B_{ij,lk}$,
but $B_{ij,kl}$ could be different from $B_{kl,ij}$, so we can use
the Voigt notation but in some cases $B_{i,j}$ could be a non symmetric
matrix.
For the different crystal systems, it is interesting to consider 
the stress present when the crystal parameters are not the equilibrium ones
and which is the influence of this stress on the relationship between 
$B_{ij,kl}$ and 
${1 \over V}{\partial^2 U \over \partial \epsilon_{ij} 
\partial \epsilon_{kl}}\Bigg|_{\epsilon=0}$. We consider each case
separately and write only the components that need to be corrected.

{\color{web-blue}\subsection{Cubic system}}
\color{black}

When the unit cell remains cubic, we can change only the parameter 
$a$ and the stress is always an isotropic pressure, so we can use the 
relationships written above.

{\color{web-blue}\subsection{Tetragonal, Hexagonal, and Trigonal systems}}
\color{black}

In the tetragonal, hexagonal, and trigonal systems the nonzero components 
of the stress tensor present when $a$ and $c/a$ (or $a$ and $\alpha$ in
the trigonal case) are not the equilibrium ones are
$\sigma^{(0)}_{11}$, $\sigma^{(0)}_{22}=\sigma^{(0)}_{11}$, and
$\sigma^{(0)}_{33}$.
Applying Eq.~\ref{eqsd2} we have:
\begin{eqnarray}
B_{11,22} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{11} 
\partial \epsilon_{22}}\Bigg|_{\epsilon=0} - \sigma^{(0)}_{11}, \\
B_{11,33} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{11} 
\partial \epsilon_{33}}\Bigg|_{\epsilon=0} - \sigma^{(0)}_{11}, \\
B_{22,11} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{22} 
\partial \epsilon_{11}}\Bigg|_{\epsilon=0} - \sigma^{(0)}_{11}, \\
B_{22,33} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{22} 
\partial \epsilon_{33}}\Bigg|_{\epsilon=0} - \sigma^{(0)}_{11}, \\
B_{33,11} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{33} 
\partial \epsilon_{11}}\Bigg|_{\epsilon=0} - \sigma^{(0)}_{33}, \\
B_{33,22} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{33} 
\partial \epsilon_{22}}\Bigg|_{\epsilon=0} - \sigma^{(0)}_{33}, \\
B_{12,12} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{12}^2 }\Bigg|_{\epsilon=0} + {1\over 2} \sigma^{(0)}_{11}, \\
B_{13,13} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{13}^2}\Bigg|_{\epsilon=0} + {1\over 4} (\sigma^{(0)}_{11}+\sigma^{(0)}_{33}), \\
B_{23,23} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{23}^2 }\Bigg|_{\epsilon=0} + {1\over 4} (\sigma^{(0)}_{11}+\sigma^{(0)}_{33}).
\end{eqnarray}

{\color{web-blue}\subsection{Orthorhombic system}}
\color{black}

In the orthorhombic system the nonzero components of the stress tensor 
present when $a$, $b/a$ and $c/a$ are not the equilibrium ones are
$\sigma^{(0)}_{11}$, $\sigma^{(0)}_{22}$, and $\sigma^{(0)}_{33}$.
Applying Eq.~\ref{eqsd2} we have:
\begin{eqnarray}
B_{11,22} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{11} 
\partial \epsilon_{22}}\Bigg|_{\epsilon=0} - \sigma^{(0)}_{11}, \\
B_{11,33} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{11} 
\partial \epsilon_{33}}\Bigg|_{\epsilon=0} - \sigma^{(0)}_{11}, \\
B_{22,11} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{22} 
\partial \epsilon_{11}}\Bigg|_{\epsilon=0} - \sigma^{(0)}_{22}, \\
B_{22,33} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{22} 
\partial \epsilon_{33}}\Bigg|_{\epsilon=0} - \sigma^{(0)}_{22}, \\
B_{33,11} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{33} 
\partial \epsilon_{11}}\Bigg|_{\epsilon=0} - \sigma^{(0)}_{33}, \\
B_{33,22} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{33} 
\partial \epsilon_{22}}\Bigg|_{\epsilon=0} - \sigma^{(0)}_{33}, \\
B_{12,12} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{12}^2 }\Bigg|_{\epsilon=0} + {1\over 4} (\sigma^{(0)}_{11} +\sigma^{(0)}_{22}), \\
B_{13,13} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{13}^2}\Bigg|_{\epsilon=0} + {1\over 4} (\sigma^{(0)}_{11}+\sigma^{(0)}_{33}), \\
B_{23,23} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{23}^2 }\Bigg|_{\epsilon=0} + {1\over 4} (\sigma^{(0)}_{22}+\sigma^{(0)}_{33}).
\end{eqnarray}

{\color{web-blue}\subsection{Monoclinic system}}
\color{black}

In this case the stress tensor differs for the $b$-unique or $c$-unique
lattices. In both cases the non-zero components can be $\sigma^{(0)}_{11}$, 
$\sigma^{(0)}_{22}$, and $\sigma^{(0)}_{33}$. In the $b$-unique case 
also $\sigma^{(0)}_{13}$ (and $\sigma^{(0)}_{31}$) can be nonvanishing, 
while in the $b$-unique case $\sigma^{(0)}_{12}$ 
(and $\sigma^{(0)}_{21}$) can be nonvanishing.
In addition to the corrections found for the orthorhombic lattice 
we have also in the $b$-unique case:
\begin{eqnarray}
B_{11,13} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{11}
\partial \epsilon_{13}}\Bigg|_{\epsilon=0} +{1\over 2}\sigma^{(0)}_{13}, \\
B_{13,11} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{13}
\partial \epsilon_{11}}\Bigg|_{\epsilon=0} -{1\over 2}\sigma^{(0)}_{13}, \\
B_{13,22} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{13}
\partial \epsilon_{22}}\Bigg|_{\epsilon=0} -\sigma^{(0)}_{13}, \\
B_{33,13} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{33}
\partial \epsilon_{13}}\Bigg|_{\epsilon=0} +{1\over 2}\sigma^{(0)}_{13}, \\
B_{13,33} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{13}
\partial \epsilon_{33}}\Bigg|_{\epsilon=0} -{1\over 2}\sigma^{(0)}_{13}, \\
B_{21,23} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{21}
\partial \epsilon_{23}}\Bigg|_{\epsilon=0} + {1\over 4}\sigma^{(0)}_{13}, \\
B_{23,21} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{23}
\partial \epsilon_{21}}\Bigg|_{\epsilon=0} +{1\over 4}\sigma^{(0)}_{13}. 
\end{eqnarray}
while for the $c$-unique case:
\begin{eqnarray}
B_{11,12} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{11}
\partial \epsilon_{12}}\Bigg|_{\epsilon=0} +{1\over 2}\sigma^{(0)}_{12}, \\
B_{12,11} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{12}
\partial \epsilon_{11}}\Bigg|_{\epsilon=0} -{1\over 2}\sigma^{(0)}_{12}, \\
B_{12,33} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{12}
\partial \epsilon_{33}}\Bigg|_{\epsilon=0} -\sigma^{(0)}_{12}, \\
B_{22,12} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{22}
\partial \epsilon_{12}}\Bigg|_{\epsilon=0} +{1\over 2}\sigma^{(0)}_{12}, \\
B_{12,22} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{12}
\partial \epsilon_{22}}\Bigg|_{\epsilon=0} -{1\over 2}\sigma^{(0)}_{12}, \\
B_{31,32} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{31}
\partial \epsilon_{32}}\Bigg|_{\epsilon=0} + {1\over 4}\sigma^{(0)}_{12}, \\
B_{32,31} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{32}
\partial \epsilon_{31}}\Bigg|_{\epsilon=0} +{1\over 4}\sigma^{(0)}_{12}. 
\end{eqnarray}

{\color{web-blue}\subsection{Triclinic system}}
\color{black}

In this case the stress tensor can have any component. 
Taking for $i$, $j$, and $k$ different values, the general formula can 
be rewritten in the form:
\begin{eqnarray}
B_{ii,jj} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{ii}
\partial \epsilon_{jj}}\Bigg|_{\epsilon=0} - \sigma^{(0)}_{ii}, \\
B_{ij,ij} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{ij}^2 
}\Bigg|_{\epsilon=0} + {1\over 4} \left(\sigma^{(0)}_{ii} 
+ \sigma^{(0)}_{jj}\right), \\
B_{ij,ik} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{ij} 
\partial \epsilon_{ik}}\Bigg|_{\epsilon=0} +{1\over 4}\sigma^{(0)}_{jk}, \\
B_{ij,kj} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{ij} 
\partial \epsilon_{kj}}\Bigg|_{\epsilon=0} +{1\over 4} \sigma^{(0)}_{ik}, \\
B_{ii,ik} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{ii} 
\partial \epsilon_{ik}}\Bigg|_{\epsilon=0} +{1\over 2} \sigma^{(0)}_{ik}, \\
B_{ik,ii} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{ik} 
\partial \epsilon_{ii}}\Bigg|_{\epsilon=0} -{1\over 2} \sigma^{(0)}_{ik}, \\
B_{ij,kk} &=& {1 \over V}{\partial^2 U \over \partial \epsilon_{ij}
\epsilon_{kk} }\Bigg|_{\epsilon=0} - \sigma^{(0)}_{ij}. 
\end{eqnarray}

\newpage
{\color{dark-blue}\chapter{Temperature dependent elastic constants}}
\color{black}

In principle to calculate the elastic constants at each temperature it
is sufficient to substitute the Helmholtz free energy to the total energy
in the equations of the previous section. 
There are however two complications
that make the calculation more difficult. One is that the stress is not
readily available at finite temperature and therefore we can use only the
energy expressions. The second is that, at each temperature, the strain should
be applied to an unstrained geometry that minimizes the Helmholtz free energy 
at temperature $T$. 
We have:
\begin{equation}
C_{ij,kl}^T= {1 \over V(T)}{\partial^2 F \over \partial \epsilon_{ij} 
\partial \epsilon_{kl}}\Bigg|_{\epsilon=0,T}.
\end{equation}
Since making an elastic constant calculation for each temperature is
quite heavy, it is necessary to approximate this expression.

One approximation known in the literature as ``quasi-static'' 
uses the energy instead of the Helmholtz free energy 
in the above expression computing the elastic constants in a regular grid of
crystal parameters and interpolating at each temperature at the geometry
that minimizes the Helmholtz free energy.

Another approximation consists in computing the derivatives of the
Helmholtz free energy but taking a fixed unstrained geometry, for instance 
the geometry that minimize the energy (i.e. the equilibrium geometry 
at $T=0$). In this approach, at each temperature, the solid has a different 
stress and we have to use the expressions written in the previous section 
in order to obtain the stress-strain elastic constants. We call 
this ``fixed-geometry quasi-harmonic'' approximation.

A third possibility consists in combining the previous two approaches,
computing the elastic constants as derivatives of the Helmholtz free
energies for a regular grid of unstrained geometries and interpolating at 
each temperature at the geometry that minimizes the Helmholtz free energy.
We call this ``quasi-harmonic'' approximation.

%\newpage
%{\color{dark-blue}\chapter{Pressure and temperature dependent elastic 
%constants}
%
%Under pressure instead of using the Helmholtz free energy we can minimize 
%the Gibbs free energy. It is possible to prove that the second derivatives 
%of the Gibbs free energy are the stress-strain elastic constants:
%\begin{equation}
%B_{ij,kl}^T= {1 \over V(T)}{\partial^2 G \over \partial 
%\epsilon_{ij} \partial \epsilon_{kl}}
%\Bigg|_{\epsilon=0,T}.
%\end{equation}
%This equation is sufficient to calculate the elastic constants at a
%given pressure and temperature. 
%In general if we compute these stress-strain elastic constants on a
%grid of crystal parameters and then interpolate them at the geometry
%that minimize the Gibbs free energy, we can calculate the 
%pressure and temperature dependent elastic constants for a 
%certain range of pressures without additional energy or phonon
%calculations.
%The range of pressures for which this approach works has to be tested changing
%the size and thickness of the grid of equilibrium configurations.
%
\newpage
{\color{dark-blue}\chapter{The elastic compliances}}
\color{black}

The relationship between stress and strain can be inverted. A stress 
applied to a solid produces a strain proportional to the stress:
\begin{equation}
\epsilon_{i} =\sum_{il} S_{i,l} \sigma_l, 
\end{equation}
where the tensor $S_{i,l}$ is known as elastic compliances. It is the
inverse of the elastic constants tensor: 
\begin{equation}
S_{i,l} = C_{i,l}^{-1}.
\end{equation}


\newpage
{\color{dark-blue}\chapter{Bulk modulus and compressibility}}
\color{black}

The isothermal compressibility is defined as the derivative of the 
equilibrium volume with respect to pressure divided by the volume,
calculated at constant temperature:
\begin{equation}
K_T = - {1 \over V} {d V \over d p}\Bigg|_T.
\end{equation}
The bulk modulus is the inverse of the compressibility. 

In order to calculate it we should calculate the change of volume
due to an external pressure $p$. Since the change of volume can be
written as 
\begin{equation}
dV = V (\epsilon_1 + \epsilon_2 + \epsilon_3)
\end{equation}
and we can calculate $\epsilon$ from the elastic compliances and the
stress $\sigma_1=-p$, $\sigma_2=-p$, $\sigma_3=-p$ we have
\begin{equation}
B_T = {1 \over S_{1,1}+S_{2,2}+S_{3,3}+2 S_{1,2}+2 S_{1,3}+2 S_{2,3}}.
\end{equation}
%In some cases it might be useful to express the bulk modulus in
%terms of the elastic constants, for instance when not all the 
%elastic constants are available and it is not possible to calculate 
%the elastic compliances. Moreover it is interesting to express
%the bulk modulus in terms of the derivatives of the free energy with
%respect to the crystal parameters $\zeta_k$.
%This depends on the Laue class and on the Bravais lattice, so we discuss
%this in the following.

\newpage
{\color{dark-blue}\chapter{Thermal expansion from Gr\"uneisen parameters}}
\color{black}

Thermal expansion can be calculated from the numerical derivatives of the 
phonon frequencies with respect to strain, doing analytically the
derivative with respect to the temperature.
From the definition of thermal expansion:
\begin{equation}
\alpha_i= \left( {d \epsilon_i \over d T}\right)_{\sigma},
\end{equation}
we can write:
\begin{equation}
\alpha_i= - \sum_j \left({d \epsilon_i \over d \sigma_j}\right)_{T} 
\left({d \sigma_j \over d T} \right)_{\epsilon} = - \sum_j S_{i,j}
\left({d \sigma_j \over d T} \right)_{\epsilon}.
\end{equation}
Using the fact that 
\begin{equation}
\left({d \sigma_j \over d T} \right)_{\epsilon} = {1\over V} {d \over d T} \left( {d F \over d \epsilon_j}\right),
\end{equation}
where $F$ is the free energy, we obtain 
\begin{equation}
\left({d \sigma_j \over d T} \right)_{\epsilon} = -\sum_{{\bf q},\nu}
\gamma_{{\bf q},\nu}^j c_{{\bf q},\nu},
\end{equation}
where
\begin{equation}
\gamma_{{\bf q},\nu}^j = -{1\over \omega_{{\bf q},\nu}} {\partial
\omega_{{\bf q},\nu} \over \partial \epsilon_j} 
\end{equation}
are the modes Gr\"uneisen parameters and 
\begin{equation}
c_{{\bf q},\nu} = {\hbar \omega_{{\bf q},\nu} \over V} {\partial
\over \partial T } \left[{1 \over e^{\beta \hbar \omega_{{\bf q},\nu}} - 1}
\right]
\end{equation}
are the mode contribution to the heat capacity.
The final expression of the thermal expansion is therefore:
\begin{equation}
\alpha_i = \sum_j S_{i,j} \sum_{{\bf q},\nu}
\gamma_{{\bf q},\nu}^j c_{{\bf q},\nu}.
\end{equation}
An accurate evaluation of this sum would require the temperature dependent
elastic compliances and the Gr\"uneisen parameters should be calculated
at the equilibrium volume at each temperature, but an approximate expression 
can be obtained neglecting this dependence and using the $T=0$ values
of the volume and of the compliances. 

Again the phonon frequencies and hence their derivatives can be calculated 
easily with respect to the crystal parameters, while we need the derivatives 
of the frequencies with respect to the strain. 
Having the strained primitive lattice vectors of a Bravais lattice 
${\bf a}'_{j,i}$ we can calculate the strain by using the reciprocal 
lattice vectors ${\bf b}_{j,i}$ of the unstrained lattice to invert
Eq.~\ref{strain_def}:
\begin{equation}
\epsilon_{j,k} = \sum_i {\bf a}'_{j,i} {{\bf b}_{k,i} \over 2 \pi} -
\delta_{j,k}.
\label{strain}
\end{equation}
We now apply this equation in some crystal systems.

{\color{web-blue}\subsection{Cubic system}}
\color{black}

By changing the cubic cell size $a$ to $a'=a+da$ and applying Eq.~\ref{strain}
we find that
\begin{equation}
\epsilon_{j,k}=\delta_{j,k} {da \over a}.
\end{equation}
So by changing $a$ the strain tensor has three non zero components on the
diagonal and therefore:
\begin{equation}
a {\partial \omega_{{\bf q}\nu} \over \partial a} = 
{\partial \omega_{{\bf q}\nu} \over \partial 
\epsilon_{1,1}} + {\partial  \omega_{{\bf q}\nu} \over \partial 
\epsilon_{2,2}} + {\partial  \omega_{{\bf q}\nu} \over \partial 
\epsilon_{3,3}}.
\label{cubic_strain}
\end{equation}
In a cubic system the three partial derivatives 
are equal and we have:
\begin{equation}
{\partial \omega_{{\bf q}\nu} 
\over \partial \epsilon_{1,1}} = {a \over 3} {\partial
 \omega_{{\bf q}\nu} \over \partial a}.
\end{equation}
%
{\color{web-blue}\subsection{Tetragonal and hexagonal systems}}
\color{black}

In these systems we first change $a$ keeping $c/a$ constant, and then
change $c/a$ by keeping $a$ constant. Using Eq.~\ref{strain} we find that
the first change corresponds to
\begin{equation}
\epsilon_{j,k}=\delta_{j,k} {da \over a},
\end{equation}
and gives Eq.~\ref{cubic_strain}, while the second strain corresponds
to $\epsilon_{3,3}= {a \over c} d (c/a) $ while all the other
components vanish. Therefore we have:
\begin{equation}
{\partial \omega_{{\bf q}\nu} 
\over \partial \epsilon_{3,3}} = {a \over c} {\partial \omega_{{\bf q}\nu} 
\over \partial c/a}.
\end{equation}
Inserting this relation in Eq.~\ref{cubic_strain} and using the fact that
in these systems 
${\partial \omega_{{\bf q}\nu} \over \partial \epsilon_{1,1}}=
{\partial \omega_{{\bf q}\nu} \over \partial \epsilon_{2,2}}$ we find:

\begin{equation}
{\partial \omega_{{\bf q}\nu} \over \partial \epsilon_{1,1}} = {1\over 2} 
\left(a  
{\partial \omega_{{\bf q}\nu} \over \partial a} -
{c\over a} {\partial \omega_{{\bf q}\nu} \over \partial c/a}\right).
\end{equation}
 
{\color{web-blue}\subsection{Trigonal system}}
\color{black}

The rhombohedral lattice can be considered also an hexagonal lattice and 
the relationships between the parameters of the hexagonal lattice
$a_h$ and $x=c_h/a_h$ and the parameters $a$ and $\cos \alpha$ of the
rhombohedral lattice are:
\begin{equation}
a={a_h \over 3} \sqrt{3 + x^2}
\end{equation}
and
\begin{equation}
\cos\alpha={ 2 x^2 - 3 \over 6 + 2 x^2}.
\end{equation}
Using the relationship found at previous point for the hexagonal system:
\begin{equation}
{\partial \omega_{{\bf q}\nu} 
\over \partial \epsilon_{3,3}} = x {\partial \omega_{{\bf q}\nu} 
\over \partial x}
\end{equation}
and
\begin{equation}
{\partial \omega_{{\bf q}\nu} 
\over \partial \epsilon_{1,1}} = 
{1\over 2} \left(a_h {\partial \omega_{{\bf q}\nu} \over \partial a_h} - 
{\partial \omega_{{\bf q}\nu} \over \partial 
\epsilon_{3,3}} \right)
\end{equation}
and transforming to the rhombohedral variables using ${\partial a \over \partial
a_h}={a\over a_h}$, ${\partial \cos \alpha \over \partial
a_h}=0$, ${\partial a \over \partial x}={a_h^2 x \over 9 a}$, and
${\partial \cos \alpha \over \partial
x}={ a_h^4 x \over 9 a^4}$ we obtain:
\begin{equation}
{\partial \omega_{{\bf q}\nu} 
\over \partial \epsilon_{3,3}} = {1\over 3} (1 + 2 \cos \alpha)
\left[ a {\partial \omega_{{\bf q}\nu} \over \partial a} +
2 (1-\cos\alpha) {\partial \omega_{{\bf q}\nu} \over \partial \cos \alpha}
\right],
\end{equation}
and
\begin{equation}
{\partial \omega_{{\bf q}\nu} \over \partial \epsilon_{1,1}} = 
{1\over 2} \left(a {\partial \omega_{{\bf q}\nu} \over \partial a} - {\partial 
\omega_{{\bf q}\nu} \over \partial 
\epsilon_{3,3}} \right).
\end{equation}

{\color{web-blue}\subsection{Orthorhombic system}}
\color{black}

In this system we can consider the three strains. We first change $a$
by keeping $b/a$ and $c/a$ constant, then we change $b/a$ by keeping $a$
and $c/a$ constant and finally we change $c/a$ by keeping $a$ and $b/a$ 
constant. With the first strain we obtain Eq.~\ref{cubic_strain}, while
the second strain correspond to
$\epsilon_{2,2}= {a \over b} d (b/a) $ while all the other
components vanish and the third strain correspond to 
$\epsilon_{3,3}= {a \over c} d (c/a) $ while all the other
components vanish.

The second strain gives:
\begin{equation}
{\partial \omega_{{\bf q}\nu} \over \partial \epsilon_{2,2}} = 
{b\over a} {\partial \omega_{{\bf q}\nu} \over \partial b/a},
\end{equation}
while the third strain gives:
\begin{equation}
{\partial \omega_{{\bf q}\nu} 
\over \partial \epsilon_{3,3}} = {c\over a} {\partial \omega_{{\bf q}\nu} 
\over \partial c/a}.
\end{equation}
Substituting these two equations in Eq.~\ref{cubic_strain} we obtain:
\begin{equation}
{\partial \omega_{{\bf q}\nu} \over \partial \epsilon_{1,1}} 
 = a {\partial \omega_{{\bf q}\nu} \over \partial a} - 
{b\over a} {\partial \omega_{{\bf q}\nu} 
\over \partial b/a} - {c\over a} {\partial \omega_{{\bf q}\nu} 
\over \partial c/a}
\end{equation}
%
\newpage
{\color{dark-blue}\chapter{Average Gr\"uneisen parameter}}
\color{black}

The product of the thermal expansion coefficient $\beta$, the bulk modulus
$B_T$, and the volume of unit cell $V$, divided by the isochoric
heat capacity $C_V$ is the average Gr\"uneisen parameter $\gamma$
that we can calculate as:
\begin{equation}
\gamma = {V B_T \beta \over C_V},
\end{equation}
and this can be calculated even for anisotropic solids if we have
calculated the bulk modulus as written above and $C_V$ as discussed in
the next section.

For anisotropic solids we can generalize this concept by introducing
the thermal stresses, as products of the elastic constants and the
thermal expansion:
\begin{equation}
b_{ij} = -\sum_{lm} C_{ij,lm} \alpha_{lm}.
\end{equation}
Multiplying this quantity by the ratio between the volume and the
constant strain heat capacity we obtain the generalized Gr\"uneisen
parameters:
\begin{equation}
\gamma_{ij} = - {V b_{ij} \over C_\epsilon}.
\end{equation}

\newpage
{\color{dark-blue}\chapter{Constant stress, isobaric, and isochoric 
heat capacities}}
\color{black}

The difference between the heat capacity calculated at constant stress
and at constant strain is given by:
\begin{equation}
C_\sigma - C_\epsilon = - T V \sum_{ij} \alpha_{ij} b_{ij}.
\end{equation}

Since a uniform pressure can be identified with a constant stress, $C_\sigma$
is also the measured isobaric heat capacity ($C_P=C_\sigma$).

The difference between the isobaric and the isochoric heat capacities 
is given by:
\begin{equation}
C_P - C_V = T V \beta^2 B_T.
\end{equation}

The difference between these two equations gives the difference between
constant strain and isochoric heat capacities:

\begin{equation}
C_\epsilon - C_V =  T V \left( \sum_{ij} \alpha_{ij} b_{ij} + \beta^2 B_T
\right),
\end{equation}
which vanishes for cubic crystals.

\newpage
{\color{dark-blue}\chapter{Adiabatic quantities}}
\color{black}

Similarly the difference between adiabatic and isothermal 
elastic compliances is given by (Voigt notation):
\begin{equation}
S^S_{i,l} - S^T_{i,l} = - {T V \alpha_{i} \alpha_{l} \over C_\sigma},
\end{equation}
while the difference between adiabatic and isothermal elastic constants
is given by:
\begin{equation}
C^S_{ij,lm} - C^T_{ij,lm} =  {T V b_{ij} b_{lm} \over C_\epsilon}.
\end{equation}
The difference between isothermal and isoentropic compressibility is given
by:
\begin{equation}
K_T - K_S =  {T V \beta^2 \over C_P}.
\end{equation}


\newpage

{\color{dark-blue}\chapter{Finite temperature electronic excitation energy}}
\color{black}

The electronic excitation energy due to the finite temperature $U_{el}$ is
neglected in semiconductors and insulators. For metals it gives a finite
contribution to the heat capacity that we estimate by a model of independent 
electrons whose energy-wave vector dispersion is given by the band structure. 
We assume Fermi-Dirac occupations of the available electronic levels:
\begin{equation}
f(E,T,\mu) = \tilde \theta({\mu - E \over k_B T}),
\end{equation}
where $\mu$ is the chemical potential and the function $\tilde \theta(x)$ is
\begin{equation}
\tilde \theta(x) = {1 \over 1 + e^{-x}}.
\end{equation}
Given the density of electronic states $N(E)$,
we determine the chemical potential $\mu(T)$ at each temperature
from the condition
\begin{equation}
N_{el} = \int_{-\infty}^\infty N(E) f(E,T,\mu) dE,
\end{equation}
where $N_{el}$ is the number of electrons per unit cell.
The electronic excitation energy $U_{el}$ is given by
\begin{equation}
U_{el}=\int_{-\infty}^\infty E N(E) f(E,T,\mu) dE - 
\int_{-\infty}^{E_F} E N(E) dE,
\end{equation}
where $E_F$ is the Fermi energy.
The electronic entropy is given:
\begin{equation}
S_{el}=-k_B\int_{-\infty}^\infty \left[ f(E,T,\mu) \ln f(E,T,\mu) 
+ (1 - f(E,T,\mu)) \ln (1 - f(E,T,\mu)) \right] N(E) dE.
\end{equation}
The electron Helmholtz free-energy is calculated by 
$F_{el}=U_{el}-TS_{el}$.
Finally the constant strain electronic specific heat is estimated by:
\begin{equation}
C_{\eta,el}=\int_{-\infty}^\infty (E - \mu) N(E) 
{\partial f(E,T,\mu) \over \partial T} dE,  
\end{equation}
where the partial derivative with respect to the temperature:
\begin{equation}
{\partial f(E,T,\mu) \over \partial T} = {E -\mu \over k_B T^2} \ \tilde 
\theta'({\mu - E \over k_B T}),
\end{equation}
indicates that, in computing the derivative, we neglect the temperature 
dependence of the chemical potential, and
\begin{equation}
\tilde \theta'(x) = {1 \over 1 + e^x+ e^{-x}}.
\end{equation}

\newpage

{\color{dark-blue}\chapter{Bibliography}}
\color{black}

\begin{enumerate}


\item
[1.] J.F. Nye, Physical properties of crystals, Oxford University press, 
Oxford (1957).

\item
[2.] D.C. Wallace, Thermodynamics of crystals, J. Wiley and Sons (1972),
Dover edition (1998).

\item
[3.] T.H.K. Barron and M.L. Klein, Proc. Phys. Soc. {\bf 85}, 523 (1965).
\end{enumerate}

\newpage

\appendix
{\color{dark-blue}\chapter{Centered lattices}}
\color{black}

It is often useful to express the primitive vectors of the centered
lattices in term of the primitive vectors of the conventional lattices
and viceversa. We report in this appendix the relationships that result
from the definitions of the primitive vectors given above.
We indicate with a prime the primitive vectors of the centered lattices. \\
Face-centered cubic lattice:
\begin{eqnarray}
{\bf a}_1'&=&{1\over 2} (-{\bf a}_1 + {\bf a}_3), \\
{\bf a}_2'&=&{1\over 2} ({\bf a}_2 + {\bf a}_3), \\
{\bf a}_3'&=&{1\over 2} (-{\bf a}_1 + {\bf a}_2). 
\end{eqnarray}

\begin{eqnarray}
{\bf a}_1&=& -{\bf a}_1' + {\bf a}_2'- {\bf a}_3', \\
{\bf a}_2&=& -{\bf a}_1' + {\bf a}_2'+ {\bf a}_3', \\
{\bf a}_3&=& {\bf a}_1' + {\bf a}_2'- {\bf a}_3' .
\end{eqnarray}
Body-centered cubic lattice:
\begin{eqnarray}
{\bf a}_1'&=&{1\over 2} ({\bf a}_1 + {\bf a}_2 + {\bf a}_3), \\
{\bf a}_2'&=&{1\over 2} (-{\bf a}_1 + {\bf a}_2 + {\bf a}_3), \\
{\bf a}_3'&=&{1\over 2} (-{\bf a}_1 - {\bf a}_2 + {\bf a}_3). 
\end{eqnarray}

\begin{eqnarray}
{\bf a}_1&=&  {\bf a}_1' - {\bf a}_2', \\
{\bf a}_2&=&  {\bf a}_2' - {\bf a}_3', \\
{\bf a}_3&=& {\bf a}_1' + {\bf a}_3'.
\end{eqnarray}
Centered tetragonal:
\begin{eqnarray}
{\bf a}_1'&=&{1\over 2} ({\bf a}_1 - {\bf a}_2 + {\bf a}_3), \\
{\bf a}_2'&=&{1\over 2} ({\bf a}_1 + {\bf a}_2 + {\bf a}_3), \\
{\bf a}_3'&=&{1\over 2} (-{\bf a}_1 - {\bf a}_2 + {\bf a}_3). 
\end{eqnarray}

\begin{eqnarray}
{\bf a}_1&=&  {\bf a}_1' - {\bf a}_3', \\
{\bf a}_2&=& -{\bf a}_1' + {\bf a}_2', \\
{\bf a}_3&=& {\bf a}_2' + {\bf a}_3'.
\end{eqnarray}
Base-centered orthorhombic:
\begin{eqnarray}
{\bf a}_1'&=&{1\over 2} ({\bf a}_1 + {\bf a}_2), \\
{\bf a}_2'&=&{1\over 2} (-{\bf a}_1 + {\bf a}_2), \\
{\bf a}_3'&=&{\bf a}_3. 
\end{eqnarray}

\begin{eqnarray}
{\bf a}_1&=&  {\bf a}_1' - {\bf a}_2', \\
{\bf a}_2&=&  {\bf a}_1' + {\bf a}_2', \\
{\bf a}_3&=& {\bf a}_3'.
\end{eqnarray}
Face-centered orthorhombic:
\begin{eqnarray}
{\bf a}_1'&=&{1\over 2} ({\bf a}_1 + {\bf a}_3), \\
{\bf a}_2'&=&{1\over 2} ({\bf a}_1 + {\bf a}_2), \\
{\bf a}_3'&=&{1\over 2} ({\bf a}_2 + {\bf a}_3), \\
\end{eqnarray}

\begin{eqnarray}
{\bf a}_1&=&  {\bf a}_1' + {\bf a}_2' - {\bf a}_3', \\
{\bf a}_2&=& -{\bf a}_1' + {\bf a}_2' + {\bf a}_3', \\
{\bf a}_3&=&  {\bf a}_1' - {\bf a}_2' + {\bf a}_3'.
\end{eqnarray}
Body-centered orthorhombic:
\begin{eqnarray}
{\bf a}_1'&=&{1\over 2} ({\bf a}_1 + {\bf a}_2 + {\bf a}_3), \\
{\bf a}_2'&=&{1\over 2} (-{\bf a}_1 + {\bf a}_2 + {\bf a}_3), \\
{\bf a}_3'&=&{1\over 2} (-{\bf a}_1 - {\bf a}_2 + {\bf a}_3). 
\end{eqnarray}

\begin{eqnarray}
{\bf a}_1&=&  {\bf a}_1' - {\bf a}_2', \\
{\bf a}_2&=&  {\bf a}_2' - {\bf a}_3', \\
{\bf a}_3&=& {\bf a}_1' + {\bf a}_3'.
\end{eqnarray}
Base-centered monoclinic ($b$-unique):
\begin{eqnarray}
{\bf a}_1'&=&{1\over 2} ({\bf a}_1 - {\bf a}_2), \\
{\bf a}_2'&=&{1\over 2} ({\bf a}_1 + {\bf a}_2), \\
{\bf a}_3'&=&{\bf a}_3. 
\end{eqnarray}

\begin{eqnarray}
{\bf a}_1&=&  {\bf a}_1' + {\bf a}_2', \\
{\bf a}_2&=& -{\bf a}_1' + {\bf a}_2', \\
{\bf a}_3&=& {\bf a}_3'.
\end{eqnarray}
Base-centered monoclinic ($c$-unique):
\begin{eqnarray}
{\bf a}_1'&=&{1\over 2} ({\bf a}_1 - {\bf a}_3), \\
{\bf a}_2'&=&{\bf a}_2, \\
{\bf a}_3'&=&{1\over 2} ({\bf a}_1 + {\bf a}_3). 
\end{eqnarray}

\begin{eqnarray}
{\bf a}_1&=& {\bf a}_1' + {\bf a}_3', \\
{\bf a}_2&=& {\bf a}_2', \\
{\bf a}_3&=& -{\bf a}_1' + {\bf a}_3'.
\end{eqnarray}

Rombohedral cell (in term of the hexagonal cell):
\begin{eqnarray}
{\bf a}_1'&=&{1\over 3} ({\bf a}_1 - {\bf a}_2 + {\bf a}_3), \\
{\bf a}_2'&=&{1\over 3} ({\bf a}_1 + 2 {\bf a}_2 + {\bf a}_3), \\
{\bf a}_3'&=&{1\over 3} (-2 {\bf a}_1 - {\bf a}_2 + {\bf a}_3). 
\end{eqnarray}

\begin{eqnarray}
{\bf a}_1&=& {\bf a}_1' - {\bf a}_3', \\
{\bf a}_2&=& - {\bf a}_1' + {\bf a}_2', \\
{\bf a}_3&=& {\bf a}_1' + {\bf a}_2' + {\bf a}_3'.
\end{eqnarray}

\end{document}
